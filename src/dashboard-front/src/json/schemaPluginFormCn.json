{
  "bk-cors": {
    "id": 1,
    "language": "",
    "notes": "为 API 增加 CORS（Cross-Origin Resource Sharing，跨域资源共享）的返回头。",
    "example": "作用：允许 https://a.example.com:8081, https://b.example.com:8081 这两个站点发起跨域请求\n\nallow_origins: \nallow_origins_by_regex: ^https://.*\\.example\\.com:8081$\nallow_methods: GET,POST,PUT,PATCH,HEAD,DELETE,OPTIONS\nallow_headers: **\nexpose_headers: \nmax_age: 86400\nallow_credential: false",
    "style": "dynamic",
    "default_value": "",
    "config": {
      "schema": {
        "type": "object",
        "required": [
          "allow_methods",
          "allow_headers",
          "max_age"
        ],
        "properties": {
          "allow_origins": {
            "description": "允许跨域访问的 Origin，格式为 scheme://host:port，示例如 https://example.com:8081。如果你有多个 Origin，请使用 , 分隔。当 allow_credential 为 false 时，可以使用 * 来表示允许所有 Origin 通过。你也可以在启用了 allow_credential 后使用 ** 强制允许所有 Origin 均通过，但请注意这样存在安全隐患。allow_origins、allow_origins_by_regex 只能一个有效。",
            "type": "string",
            "pattern": "^(|\\*|\\*\\*|null|http(s)?://[-a-zA-Z0-9:\\[\\]\\.]+(,http(s)?://[-a-zA-Z0-9:\\[\\]\\.]+)*)$",
            "maxLength": 4096,
            "default": "",
            "ui:props": {
              "labelWidth": 200
            }
          },
          "allow_origins_by_regex": {
            "description": "使用正则表示的允许跨域访问的 Origin，示例如 '^https://.*\\.example\\.com:8081$'，此正则允许 https://a.example.com:8081, https://b.example.com:8081。allow_origins、allow_origins_by_regex 只能一个有效。",
            "type": "array",
            "uniqueItems": true,
            "items": {
              "type": "string",
              "minLength": 1,
              "maxLength": 4096,
              "pattern": "^(\\^)?[-a-zA-Z0-9:/\\[\\]\\{\\}\\(\\)\\.\\*\\+\\?\\|\\\\]+(\\$)?$"
            },
            "ui:component": {
              "name": "bfArray"
            },
            "ui:props": {
              "labelWidth": 200
            }
          },
          "allow_methods": {
            "description": "允许跨域访问的 Method，比如：GET，POST 等。如果你有多个 Method，请使用 , 分割。当 allow_credential 为 false 时，可以使用 * 来表示允许所有 Method 通过。你也可以在启用了 allow_credential 后使用 ** 强制允许所有 Method 都通过，但请注意这样存在安全隐患。",
            "type": "string",
            "default": "**",
            "pattern": "^(\\*|\\*\\*|(GET|POST|PUT|DELETE|PATCH|HEAD|OPTIONS|CONNECT|TRACE)(,(GET|POST|PUT|DELETE|PATCH|HEAD|OPTIONS|CONNECT|TRACE))*)$",
            "maxLength": 100,
            "ui:rules": [
              "required"
            ],
            "ui:props": {
              "labelWidth": 200
            }
          },
          "allow_headers": {
            "description": "允许跨域访问时请求方携带哪些非 CORS 规范 以外的 Header。如果你有多个 Header，请使用 , 分割。当 allow_credential 为 false 时，可以使用 * 来表示允许所有 Header 通过。你也可以在启用了 allow_credential 后使用 ** 强制允许所有 Header 都通过，但请注意这样存在安全隐患。",
            "type": "string",
            "default": "**",
            "pattern": "^(\\*|\\*\\*|[-a-zA-Z0-9]+(,[-a-zA-Z0-9]+)*)$",
            "maxLength": 4096,
            "ui:rules": [
              "required"
            ],
            "ui:props": {
              "labelWidth": 200
            }
          },
          "expose_headers": {
            "description": "允许跨域访问时响应方携带哪些非 CORS 规范 以外的 Header。如果你有多个 Header，请使用 , 分割。当 allow_credential 为 false 时，可以使用 * 来表示允许任意 Header。你也可以在启用了 allow_credential 后使用 ** 强制允许任意 Header，但请注意这样存在安全隐患。",
            "type": "string",
            "pattern": "^(|\\*|\\*\\*|[-a-zA-Z0-9]+(,[-a-zA-Z0-9]+)*)$",
            "maxLength": 4096,
            "default": "",
            "ui:props": {
              "labelWidth": 200
            }
          },
          "max_age": {
            "description": "浏览器缓存 CORS 结果的最大时间，单位为秒。在这个时间范围内，浏览器会复用上一次的检查结果，-1 表示不缓存。请注意各个浏览器允许的最大时间不同。",
            "type": "integer",
            "default": 86400,
            "ui:rules": [
              "required"
            ],
            "ui:component": {
              "name": "bfInput",
              "min": -1,
              "unit": "秒"
            },
            "ui:props": {
              "labelWidth": 200
            }
          },
          "allow_credential": {
            "description": "是否允许跨域访问的请求方携带凭据（如 Cookie 等）。根据 CORS 规范，如果设置该选项为 true，那么将不能在其他属性中使用 *。",
            "type": "boolean",
            "default": true,
            "ui:props": {
              "labelWidth": 200
            }
          }
        }
      },
      "layout": [],
      "formData": {},
      "rules": {}
    },
    "type_id": 1,
    "type_code": "bk-cors",
    "type_name": "跨域资源共享（CORS）"
  },
  "bk-ip-restriction": {
    "id": 5,
    "language": "",
    "notes": "通过将 IP 地址列入白名单或黑名单来限制对资源的访问。支持 CIDR。每行一条数据, 并且支持空行及注释行（以 # 开头）。",
    "example": "作用：仅允许 IP 192.168.1.1 和 192.168.1.1 请求当前接口\n\n类型：白名单\n白名单： \n      # comment\n       192.168.1.1\n       192.168.1.2",
    "style": "dynamic",
    "default_value": "",
    "config": {
      "schema": {
        "type": "object",
        "oneOf": [
          {
            "required": [
              "whitelist"
            ],
            "title": "白名单",
            "properties": {
              "whitelist": {
                "type": "string",
                "maxLength": 51200,
                "minLength": 7,
                "title": "白名单",
                "ui:component": {
                  "type": "textarea",
                  "rows": 10
                }
              }
            }
          },
          {
            "required": [
              "blacklist"
            ],
            "title": "黑名单",
            "properties": {
              "blacklist": {
                "type": "string",
                "maxLength": 51200,
                "minLength": 7,
                "title": "黑名单",
                "ui:component": {
                  "type": "textarea",
                  "rows": 10
                }
              }
            }
          }
        ],
        "ui:oneOf": {
          "title": "类型"
        }
      },
      "layout": [],
      "formData": {},
      "rules": {}
    },
    "type_id": 3,
    "type_code": "bk-ip-restriction",
    "type_name": "IP 访问保护"
  },
  "bk-rate-limit": {
    "id": 7,
    "language": "",
    "notes": "限制每个应用调用的请求频率。默认应用频率限制对所有应用生效，特殊应用频率限制对指定应用单独生效。\n如果在环境和资源上都配置，两个都会生效，并且在环境上配置表示对应用访问环境下所有资源的总访问频率进行限制。",
    "example": "作用：默认每个应用 100 次/秒，应用 demo 200 次/秒\n\n默认频率限制：次数：100 时间范围：秒\n特殊应用频率限制：次数：200  时间范围：秒  蓝鲸应用 ID: demo",
    "style": "dynamic",
    "default_value": "",
    "config": {
      "schema": {
        "title": "频率控制",
        "type": "object",
        "properties": {
          "rates": {
            "type": "object",
            "properties": {
              "default": {
                "type": "object",
                "title": "默认应用频率限制",
                "description": "每个应用可以调用的默认频率，以应用维度进行限制",
                "ui:group": {
                  "type": "card",
                  "showTitle": true,
                  "style": {
                    "background": "#F5F7FA",
                    "padding": "10px 20px 10px 16px"
                  }
                },
                "required": [
                  "tokens",
                  "period"
                ],
                "properties": {
                  "tokens": {
                    "type": "integer",
                    "title": "次数",
                    "default": 100,
                    "ui:rules": [
                      "required"
                    ],
                    "ui:component": {
                      "name": "bfInput",
                      "min": 1
                    },
                    "ui:props": {
                      "labelWidth": 100
                    }
                  },
                  "period": {
                    "type": "integer",
                    "title": "时间范围",
                    "default": 1,
                    "ui:rules": [
                      "required"
                    ],
                    "ui:component": {
                      "name": "select",
                      "datasource": [
                        {
                          "label": "秒",
                          "value": 1
                        },
                        {
                          "label": "分",
                          "value": 60
                        },
                        {
                          "label": "时",
                          "value": 3600
                        },
                        {
                          "label": "天",
                          "value": 86400
                        }
                      ],
                      "clearable": false
                    },
                    "ui:props": {
                      "labelWidth": 100
                    }
                  }
                }
              },
              "specials": {
                "type": "array",
                "title": "特殊应用频率限制",
                "description": "特殊应用可以调用的频率限制，例如针对某些应用给到更大的调用频率",
                "ui:group": {
                  "type": "card",
                  "showTitle": true,
                  "style": {
                    "background": "#F5F7FA",
                    "padding": "10px 20px 20px 16px"
                  }
                },
                "items": {
                  "type": "object",
                  "required": [
                    "tokens",
                    "period",
                    "bk_app_code"
                  ],
                  "ui:group": {
                    "style": {
                      "background": "#FFF",
                      "padding": "10px 10px 10px 10px"
                    }
                  },
                  "properties": {
                    "tokens": {
                      "type": "integer",
                      "title": "次数",
                      "default": 200,
                      "ui:rules": [
                        "required"
                      ],
                      "ui:component": {
                        "name": "bfInput",
                        "min": 1
                      },
                      "ui:props": {
                        "labelWidth": 90
                      }
                    },
                    "period": {
                      "type": "integer",
                      "title": "时间范围",
                      "default": 1,
                      "ui:rules": [
                        "required"
                      ],
                      "ui:component": {
                        "name": "select",
                        "datasource": [
                          {
                            "label": "秒",
                            "value": 1
                          },
                          {
                            "label": "分",
                            "value": 60
                          },
                          {
                            "label": "时",
                            "value": 3600
                          },
                          {
                            "label": "天",
                            "value": 86400
                          }
                        ],
                        "clearable": false
                      },
                      "ui:props": {
                        "labelWidth": 100
                      }
                    },
                    "bk_app_code": {
                      "type": "string",
                      "title": "蓝鲸应用 ID",
                      "pattern": "^[a-z][a-z0-9_-]{0,31}$",
                      "ui:rules": [
                        "required"
                      ],
                      "ui:props": {
                        "labelWidth": 100
                      }
                    }
                  }
                }
              }
            }
          }
        }
      },
      "layout": [
        [
          {
            "prop": "rates",
            "group": [
              [
                {
                  "prop": "default",
                  "container": {
                    "grid-template-columns": "250px 200px"
                  },
                  "group": [
                    [
                      "tokens",
                      "period"
                    ]
                  ]
                }
              ],
              [
                {
                  "prop": "specials",
                  "container": {
                    "grid-template-columns": "250px 200px 250px"
                  },
                  "group": [
                    [
                      "tokens",
                      "period",
                      "bk_app_code"
                    ]
                  ]
                }
              ]
            ]
          }
        ]
      ],
      "formData": {},
      "rules": {}
    },
    "type_id": 4,
    "type_code": "bk-rate-limit",
    "type_name": "频率控制"
  },
  "bk-header-rewrite": {
    "id": 3,
    "language": "",
    "notes": "对请求添加或删除请求头。\n注意设置的值中支持`$`符号，（变量，不存在则为空）; `$arg_foo`获取 query string 中`foo`的值，`$http_bar`可以获取 header 中 `bar`的值。",
    "example": "作用：设置 header `X-Api-Version: 1`，并且删除 header `X-test`\n\n设置：X-Api-Version: 1\n删除：X-test",
    "style": "dynamic",
    "default_value": "",
    "config": {
      "schema": {
        "properties": {
          "set": {
            "description": "设置的请求头",
            "items": {
              "properties": {
                "key": {
                  "title": "键",
                  "description": "您可以设置请求头的键，请求头的键中不能包含冒号（:）。",
                  "type": "string",
                  "maxLength": 1024,
                  "pattern": "^[\\w-]+$",
                  "ui:rules": [
                    "required"
                  ]
                },
                "value": {
                  "title": "值",
                  "description": "您可以设置请求头的值。",
                  "type": "string",
                  "maxLength": 1024,
                  "pattern": "^[\\s\\S]*$",
                  "ui:rules": [
                    "required"
                  ]
                }
              },
              "type": "object"
            },
            "minItems": 0,
            "title": "设置",
            "type": "array",
            "ui:component": {
              "name": "bfArray"
            },
            "ui:rules": [
              {
                "validator": "{{ $self.getValue('set').length || $self.getValue('remove').length }}",
                "message": "请求头设置或删除至少需要配置一个"
              }
            ]
          },
          "remove": {
            "description": "删除的请求头",
            "items": {
              "properties": {
                "key": {
                  "title": "键",
                  "description": "您可以删除请求头的键，请求头的键中不能包含冒号（:）。",
                  "type": "string",
                  "maxLength": 1024,
                  "pattern": "^[\\w-]+$",
                  "ui:rules": [
                    "required"
                  ]
                }
              },
              "type": "object"
            },
            "minItems": 0,
            "title": "删除",
            "type": "array",
            "uniqueItems": true,
            "ui:component": {
              "name": "bfArray"
            },
            "ui:rules": [
              {
                "validator": "{{ $self.getValue('set').length || $self.getValue('remove').length }}",
                "message": "请求头设置或删除至少需要配置一个"
              }
            ]
          }
        },
        "type": "object"
      }
    },
    "type_id": 2,
    "type_code": "bk-header-rewrite",
    "type_name": "Header 转换"
  }
}