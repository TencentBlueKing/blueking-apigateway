- model: schema.schema
  fields:
    created_time: 2023-02-02 14:54:21.010753+00:00
    updated_time: 2023-02-02 14:54:21.010788+00:00
    name: bk-cors
    type: plugin
    version: '0'
    _schema: |-
      {
        "$comment": "this is a mark for our injected plugin schema",
        "type": "object",
        "properties": {
          "allow_origins": {
            "description": "you can use '*' to allow all origins when no credentials, '**' to allow forcefully(it will bring some security risks, be carefully), multiple origin use ',' to split. default: *.",
            "type": "string",
            "pattern": "^(\\*|\\*\\*|null|\\w+://[^,]+(,\\w+://[^,]+)*)$",
            "default": "*"
          },
          "allow_methods": {
            "description": "you can use '*' to allow all methods when no credentials, '**' to allow forcefully(it will bring some security risks, be carefully), multiple method use ',' to split. default: *.",
            "type": "string",
            "default": "*"
          },
          "allow_headers": {
            "description": "you can use '*' to allow all header when no credentials, '**' to allow forcefully(it will bring some security risks, be carefully), multiple header use ',' to split. default: *.",
            "type": "string",
            "default": "*"
          },
          "expose_headers": {
            "description": "you can use '*' to expose all header when no credentials, '**' to allow forcefully(it will bring some security risks, be carefully), multiple header use ',' to split. default: *.",
            "type": "string",
            "default": "*"
          },
          "max_age": {
            "description": "maximum number of seconds the results can be cached. -1 means no cached, the max value is depend on browser, more details plz check MDN. default: 5.",
            "type": "integer",
            "default": 5
          },
          "allow_credential": {
            "description": "allow client append credential. according to CORS specification, if you set this option to 'true', you can not use '*' for other options.",
            "type": "boolean",
            "default": false
          },
          "allow_origins_by_regex": {
            "type": "array",
            "description": "you can use regex to allow specific origins when no credentials, for example use [.*\\.test.com] to allow a.test.com and b.test.com",
            "items": {
              "type": "string",
              "minLength": 1,
              "maxLength": 4096
            },
            "minItems": 1,
            "uniqueItems": true
          },
          "allow_origins_by_metadata": {
            "type": "array",
            "description": "set allowed origins by referencing origins in plugin metadata",
            "items": {
              "type": "string",
              "minLength": 1,
              "maxLength": 4096
            },
            "minItems": 1,
            "uniqueItems": true
          },
          "_meta": {
            "type": "object",
            "properties": {
              "priority": {
                "description": "priority of plugins by customized order",
                "type": "integer"
              },
              "disable": {
                "type": "boolean"
              },
              "error_response": {
                "oneOf": [
                  {
                    "type": "string"
                  },
                  {
                    "type": "object"
                  }
                ]
              },
              "filter": {
                "description": "filter determines whether the plugin needs to be executed at runtime",
                "type": "array"
              }
            }
          }
        }
      }
    description: '-'
    example: '-'
- model: plugin.plugintype
  fields:
    code: bk-cors
    name: 跨域资源共享（CORS）
    name_en: Cross-Origin Resource Sharing (CORS)
    is_public: true
    scope: stage_and_resource
    schema:
    - bk-cors
    - plugin
    - '0'
- model: plugin.pluginform
  fields:
    language: ''
    type:
    - bk-cors
    notes: cors 插件支持为后端服务增加 CORS（Cross-Origin Resource Sharing，跨域资源共享）的返回头。
    example: "作用：允许https://a.example.com:8081, https://b.example.com:8081 这两个站点发起跨域请求\n\nallow_origins: \nallow_origins_by_regex: ^https://.*\\.example\\.com:8081$\nallow_methods: GET,POST,PUT,PATCH,HEAD,DELETE,OPTIONS\nallow_headers: **\nexpose_headers: \nmax_age: 86400\nallow_credential: false"
    style: dynamic
    default_value: ''
    config: |-
      {
        "schema": {
          "type": "object",
          "required": [
            "allow_methods",
            "allow_headers",
            "max_age"
          ],
          "properties": {
            "allow_origins": {
              "description": "允许跨域访问的 Origin，格式为 scheme://host:port，示例如 https://example.com:8081。如果你有多个 Origin，请使用 , 分隔。当 allow_credential 为 false 时，可以使用 * 来表示允许所有 Origin 通过。你也可以在启用了 allow_credential 后使用 ** 强制允许所有 Origin 均通过，但请注意这样存在安全隐患。allow_origins、allow_origins_by_regex 只能一个有效。",
              "type": "string",
              "pattern": "^(|\\*|\\*\\*|null|http(s)?://[-a-zA-Z0-9:\\[\\]\\.]+(,http(s)?://[-a-zA-Z0-9:\\[\\]\\.]+)*)$",
              "maxLength": 4096,
              "default": ""
            },
            "allow_origins_by_regex": {
              "description": "使用正则表示的允许跨域访问的 Origin，示例如 '^https://.*\\.example\\.com:8081$'，此正则允许 https://a.example.com:8081, https://b.example.com:8081。allow_origins、allow_origins_by_regex 只能一个有效。",
              "type": "array",
              "uniqueItems": true,
              "items": {
                "type": "string",
                "minLength": 1,
                "maxLength": 4096,
                "pattern": "^(\\^)?[-a-zA-Z0-9:/\\[\\]\\{\\}\\(\\)\\.\\*\\+\\?\\|\\\\]+(\\$)?$"
              },
              "ui:component": {
                "name": "bfArray"
              }
            },
            "allow_methods": {
              "description": "允许跨域访问的 Method，比如：GET，POST 等。如果你有多个 Method，请使用 , 分割。当 allow_credential 为 false 时，可以使用 * 来表示允许所有 Method 通过。你也可以在启用了 allow_credential 后使用 ** 强制允许所有 Method 都通过，但请注意这样存在安全隐患。",
              "type": "string",
              "default": "**",
              "pattern": "^(\\*|\\*\\*|(GET|POST|PUT|DELETE|PATCH|HEAD|OPTIONS|CONNECT|TRACE)(,(GET|POST|PUT|DELETE|PATCH|HEAD|OPTIONS|CONNECT|TRACE))*)$",
              "maxLength": 100,
              "ui:rules": [
                "required"
              ]
            },
            "allow_headers": {
              "description": "允许跨域访问时请求方携带哪些非 CORS 规范 以外的 Header。如果你有多个 Header，请使用 , 分割。当 allow_credential 为 false 时，可以使用 * 来表示允许所有 Header 通过。你也可以在启用了 allow_credential 后使用 ** 强制允许所有 Header 都通过，但请注意这样存在安全隐患。",
              "type": "string",
              "default": "**",
              "pattern": "^(\\*|\\*\\*|[-a-zA-Z0-9]+(,[-a-zA-Z0-9]+)*)$",
              "maxLength": 4096,
              "ui:rules": [
                "required"
              ]
            },
            "expose_headers": {
              "description": "允许跨域访问时响应方携带哪些非 CORS 规范 以外的 Header。如果你有多个 Header，请使用 , 分割。当 allow_credential 为 false 时，可以使用 * 来表示允许任意 Header。你也可以在启用了 allow_credential 后使用 ** 强制允许任意 Header，但请注意这样存在安全隐患。",
              "type": "string",
              "pattern": "^(|\\*|\\*\\*|[-a-zA-Z0-9]+(,[-a-zA-Z0-9]+)*)$",
              "maxLength": 4096,
              "default": ""
            },
            "max_age": {
              "description": "浏览器缓存 CORS 结果的最大时间，单位为秒。在这个时间范围内，浏览器会复用上一次的检查结果，-1 表示不缓存。请注意各个浏览器允许的最大时间不同。",
              "type": "integer",
              "default": 86400,
              "ui:rules": [
                "required"
              ],
              "ui:component": {
                "name": "bfInput",
                "min": -1,
                "unit": "秒"
              }
            },
            "allow_credential": {
              "description": "是否允许跨域访问的请求方携带凭据（如 Cookie 等）。根据 CORS 规范，如果设置该选项为 true，那么将不能在其他属性中使用 *。",
              "type": "boolean",
              "default": true
            }
          }
        },
        "layout": [],
        "formData": {},
        "rules": {}
      }
- model: plugin.pluginform
  fields:
    language: en
    type:
    - bk-cors
    notes: The cors Plugins lets you enable CORS easily.
    example: "Function: allows https://a.example.com:8081, https://b.example.com:8081 this two site launch cross-domain request\n\nallow_origins: \nallow_origins_by_regex: ^https://.*\\.example\\.com:8081$\nallow_methods: GET,POST,PUT,PATCH,HEAD,DELETE,OPTIONS\nallow_headers: **\nexpose_headers: \nmax_age: 86400\nallow_credential: false"
    style: dynamic
    default_value: ''
    config: |-
      {
        "schema": {
          "type": "object",
          "required": [
            "allow_methods",
            "allow_headers",
            "max_age"
          ],
          "properties": {
            "allow_origins": {
              "description": "Origins to allow CORS. Use the scheme://host:port format. For example, https://example.com:8081. If you have multiple origins, use a , to list them. If allow_credential is set to false, you can enable CORS for all origins by using *. If allow_credential is set to true, you can forcefully allow CORS on all origins by using ** but it will pose some security issues. allow_origins, allow_origins_by_regex can only be one valid at a time.",
              "type": "string",
              "pattern": "^(|\\*|\\*\\*|null|http(s)?://[-a-zA-Z0-9:\\[\\]\\.]+(,http(s)?://[-a-zA-Z0-9:\\[\\]\\.]+)*)$",
              "default": ""
            },
            "allow_origins_by_regex": {
              "description": "Origin that allows CORS using regular expressions. You can use regex to allow specific origins when no credentials, for example, '^https://.*\\.example\\.com:8081$', this regular expression allows https://a.example.com:8081, https://b.example.com:8081. allow_origins, allow_origins_by_regex can only be one valid at a time.",
              "type": "array",
              "uniqueItems": true,
              "items": {
                "type": "string",
                "minLength": 1,
                "maxLength": 4096,
                "pattern": "^(\\^)?[-a-zA-Z0-9:/\\[\\]\\{\\}\\(\\)\\.\\*\\+\\?\\|\\\\]+(\\$)?$"
              },
              "ui:component": {
                "name": "bfArray"
              }
            },
            "allow_methods": {
              "description": "Request methods to enable CORS on. For example GET, POST. Use , to add multiple methods. If allow_credential is set to false, you can enable CORS for all methods by using *. If allow_credential is set to true, you can forcefully allow CORS on all methods by using ** but it will pose some security issues.",
              "type": "string",
              "default": "**",
              "pattern": "^(\\*|\\*\\*|(GET|POST|PUT|DELETE|PATCH|HEAD|OPTIONS|CONNECT|TRACE)(,(GET|POST|PUT|DELETE|PATCH|HEAD|OPTIONS|CONNECT|TRACE))*)$",
              "maxLength": 100,
              "ui:rules": [
                "required"
              ]
            },
            "allow_headers": {
              "description": "Headers in the request allowed when accessing a cross-origin resource. Use , to add multiple headers. If allow_credential is set to false, you can enable CORS for all request headers by using *. If allow_credential is set to true, you can forcefully allow CORS on all request headers by using ** but it will pose some security issues.",
              "type": "string",
              "default": "**",
              "pattern": "^(\\*|\\*\\*|[-a-zA-Z0-9]+(,[-a-zA-Z0-9]+)*)$",
              "maxLength": 4096,
              "ui:rules": [
                "required"
              ]
            },
            "expose_headers": {
              "description": "Headers in the response allowed when accessing a cross-origin resource. Use , to add multiple headers. If allow_credential is set to false, you can enable CORS for all response headers by using *. If allow_credential is set to true, you can forcefully allow CORS on all response headers by using ** but it will pose some security issues.",
              "type": "string",
              "pattern": "^(|\\*|\\*\\*|[-a-zA-Z0-9]+(,[-a-zA-Z0-9]+)*)$",
              "maxLength": 4096,
              "default": ""
            },
            "max_age": {
              "description": "Maximum time in seconds the result is cached. If the time is within this limit, the browser will check the cached result. Set to -1 to disable caching. Note that the maximum value is browser dependent.",
              "type": "integer",
              "default": 86400,
              "ui:rules": [
                "required"
              ],
              "ui:component": {
                "name": "bfInput",
                "min": -1,
                "unit": "Seconds"
              }
            },
            "allow_credential": {
              "description": "When set to true, allows requests to include credentials like cookies. According to CORS specification, if you set this to true, you cannot use '*' to allow all for the other attributes.",
              "type": "boolean",
              "default": true
            }
          }
        },
        "layout": [],
        "formData": {},
        "rules": {}
      }
- model: schema.schema
  fields:
    created_time: 2023-07-07 11:48:21.010753+00:00
    updated_time: 2023-07-07 11:48:21.010788+00:00
    name: bk-header-rewrite
    type: plugin
    version: '0'
    _schema: |-
      {
        "$comment": "this is a mark for our injected plugin schema",
        "type": "object",
        "description": "new headers for request",
        "minProperties": 1,
        "additionalProperties": false,
        "properties": {
          "set": {
            "type": "object",
            "patternProperties": {
              "^[^:]+$": {
                "oneOf": [
                  {
                    "type": "string"
                  },
                  {
                    "type": "number"
                  }
                ]
              }
            }
          },
          "remove": {
            "type": "array",
            "items": {
              "type": "string",
              "pattern": "^[^:]+$"
            }
          }
        }
      }
    description: '-'
    example: '-'
- model: plugin.plugintype
  fields:
    code: bk-header-rewrite
    name: Header 转换
    name_en: Header transformation
    is_public: true
    scope: stage_and_resource
    schema:
    - bk-header-rewrite
    - plugin
    - '0'
- model: plugin.pluginform
  fields:
    language: ''
    type:
    - bk-header-rewrite
    notes: Header 转换插件支持对请求添加或删除请求头。注意设置的值中如果包含`$`符号，会被认为是变量被变量的值替换（不存在的变量值为空）; `$arg_foo`可获取 query string中`foo`的值, `$http_bar`可以获取 header 中 `bar`的值。
    example: "作用：设置header `X-Api-Version: 1`， 并且删除header `X-test`\n\n设置: X-Api-Version: 1\n删除: X-test"
    style: dynamic
    default_value: ''
    config: |-
      {
        "schema": {
          "properties": {
            "set": {
              "description": "设置的请求头",
              "items": {
                "properties": {
                  "key": {
                    "title": "键",
                    "description": "您可以设置请求头的键，请求头的键中不能包含冒号（:）。",
                    "type": "string",
                    "maxLength": 1024,
                    "pattern": "^[\\w-]+$",
                    "ui:rules": [
                      "required"
                    ]
                  },
                  "value": {
                    "title": "值",
                    "description": "您可以设置请求头的值。",
                    "type": "string",
                    "maxLength": 1024,
                    "pattern": "^[\\s\\S]*$",
                    "ui:rules": [
                      "required"
                    ]
                  }
                },
                "type": "object"
              },
              "minItems": 0,
              "title": "设置",
              "type": "array",
              "ui:component": {
                "name": "bfArray"
              },
              "ui:rules": [
                {
                  "validator": "{{ $self.getValue('set').length || $self.getValue('remove').length }}",
                  "message": "请求头设置或删除至少需要配置一个"
                }
              ]
            },
            "remove": {
              "description": "删除的请求头",
              "items": {
                "properties": {
                  "key": {
                    "title": "键",
                    "description": "您可以删除请求头的键，请求头的键中不能包含冒号（:）。",
                    "type": "string",
                    "maxLength": 1024,
                    "pattern": "^[\\w-]+$",
                    "ui:rules": [
                      "required"
                    ]
                  }
                },
                "type": "object"
              },
              "minItems": 0,
              "title": "删除",
              "type": "array",
              "uniqueItems": true,
              "ui:component": {
                "name": "bfArray"
              },
              "ui:rules": [
                {
                  "validator": "{{ $self.getValue('set').length || $self.getValue('remove').length }}",
                  "message": "请求头设置或删除至少需要配置一个"
                }
              ]
            }
          },
          "type": "object"
        }
      }
- model: plugin.pluginform
  fields:
    language: en
    type:
    - bk-header-rewrite
    notes: Header transformation plugins allow you to easily add or remove request headers. If a value for a setting contains the $ symbol, it will be treated as a variable and its value will be replaced (with the variable’s value or empty if the variable does not exist). `$arg_foo` can fetch the value of `foo` from the query string, and `$http_bar` can fetch the value of `bar` from the header.
    example: "Function: Set header 'X-Api-Version: 1' and delete header 'X-test'\n\nSettings: X-Api-Version: 1\nDelete: X-test"
    style: dynamic
    default_value: ''
    config: |-
      {
        "schema": {
          "properties": {
            "set": {
              "description": "set headers",
              "items": {
                "properties": {
                  "key": {
                    "title": "key",
                    "description": "You can set the key of the request header, but colons (:) cannot appear in the key of the request header.",
                    "type": "string",
                    "maxLength": 1024,
                    "pattern": "^[\\w-]+$",
                    "ui:rules": [
                      "required"
                    ]
                  },
                  "value": {
                    "title": "value",
                    "description": "You can set the value of the request header.",
                    "type": "string",
                    "maxLength": 1024,
                    "pattern": "^[\\s\\S]*$",
                    "ui:rules": [
                      "required"
                    ]
                  }
                },
                "type": "object"
              },
              "minItems": 0,
              "title": "set",
              "type": "array",
              "ui:component": {
                "name": "bfArray"
              },
              "ui:rules": [
                {
                  "validator": "{{ $self.getValue('set').length || $self.getValue('remove').length }}",
                  "message": "At least one operation is required when setting or removing request headers."
                }
              ]
            },
            "remove": {
              "description": "remove headers",
              "items": {
                "properties": {
                  "key": {
                    "title": "key",
                    "description": "You can remove the key of the request header, but colons (:) cannot appear in the key of the request header.",
                    "type": "string",
                    "maxLength": 1024,
                    "pattern": "^[\\w-]+$",
                    "ui:rules": [
                      "required"
                    ]
                  }
                },
                "type": "object"
              },
              "minItems": 0,
              "title": "remove",
              "type": "array",
              "uniqueItems": true,
              "ui:component": {
                "name": "bfArray"
              },
              "ui:rules": [
                {
                  "validator": "{{ $self.getValue('set').length || $self.getValue('remove').length }}",
                  "message": "At least one operation is required when setting or removing request headers."
                }
              ]
            }
          },
          "type": "object"
        }
      }
- model: schema.schema
  fields:
    created_time: 2022-11-24 11:59:49.409202+00:00
    updated_time: 2023-02-01 08:08:33.453910+00:00
    name: bk-ip-restriction
    type: plugin
    version: '0'
    _schema: |-
      {
        "$comment": "this is a mark for our injected plugin schema",
        "properties": {
          "whitelist": {
            "items": {
              "anyOf": [
                {
                  "format": "ipv4",
                  "type": "string",
                  "title": "IPv4"
                },
                {
                  "pattern": "^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])/([12]?[0-9]|3[0-2])$",
                  "type": "string",
                  "title": "IPv4/CIDR"
                },
                {
                  "format": "ipv6",
                  "type": "string",
                  "title": "IPv6"
                },
                {
                  "pattern": "^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?/[0-9]{1,3}$",
                  "type": "string",
                  "title": "IPv6/CIDR"
                }
              ]
            },
            "type": "array",
            "minItems": 1
          },
          "message": {
            "default": "Your IP address is not allowed",
            "minLength": 1,
            "type": "string",
            "maxLength": 1024
          },
          "blacklist": {
            "items": {
              "anyOf": [
                {
                  "format": "ipv4",
                  "type": "string",
                  "title": "IPv4"
                },
                {
                  "pattern": "^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])/([12]?[0-9]|3[0-2])$",
                  "type": "string",
                  "title": "IPv4/CIDR"
                },
                {
                  "format": "ipv6",
                  "type": "string",
                  "title": "IPv6"
                },
                {
                  "pattern": "^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?/[0-9]{1,3}$",
                  "type": "string",
                  "title": "IPv6/CIDR"
                }
              ]
            },
            "type": "array",
            "minItems": 1
          },
          "_meta": {
            "type": "object",
            "properties": {
              "error_response": {
                "oneOf": [
                  {
                    "type": "string"
                  },
                  {
                    "type": "object"
                  }
                ]
              },
              "disable": {
                "type": "boolean"
              },
              "priority": {
                "description": "priority of plugins by customized order",
                "type": "integer"
              },
              "filter": {
                "description": "filter determines whether the plugin needs to be executed at runtime",
                "type": "array"
              }
            }
          }
        },
        "type": "object",
        "oneOf": [
          {
            "required": [
              "whitelist"
            ]
          },
          {
            "required": [
              "blacklist"
            ]
          }
        ]
      }
    description: '-'
    example: '-'
- model: plugin.plugintype
  fields:
    code: bk-ip-restriction
    name: IP 访问保护
    name_en: IP restriction
    is_public: true
    scope: stage_and_resource
    schema:
    - bk-ip-restriction
    - plugin
    - '0'
- model: plugin.pluginform
  fields:
    language: ''
    type:
    - bk-ip-restriction
    notes: |-
      该插件可以通过将 IP 地址列入白名单或黑名单来限制对资源的访问。
      支持对单个 IP 地址、多个 IP 地址和类似 1.1.1.0/24 的 CIDR（无类别域间路由）范围的限制。
      每行一条数据, 并且支持空行及注释行（以 # 开头）。
    example: "作用：仅允许 IP 192.168.1.1 和 192.168.1.1 请求当前接口\n\n类型：白名单\n白名单： # comment\n       192.168.1.1\n       192.168.1.2"
    style: dynamic
    default_value: ''
    config: |-
      {
        "schema": {
          "type": "object",
          "oneOf": [
            {
              "required": [
                "whitelist"
              ],
              "title": "白名单",
              "properties": {
                "whitelist": {
                  "type": "string",
                  "maxLength": 51200,
                  "minLength": 7,
                  "title": "白名单",
                  "ui:component": {
                    "type": "textarea",
                    "rows": 10
                  }
                }
              }
            },
            {
              "required": [
                "blacklist"
              ],
              "title": "黑名单",
              "properties": {
                "blacklist": {
                  "type": "string",
                  "maxLength": 51200,
                  "minLength": 7,
                  "title": "黑名单",
                  "ui:component": {
                    "type": "textarea",
                    "rows": 10
                  }
                }
              }
            }
          ],
          "ui:oneOf": {
            "title": "类型"
          }
        },
        "layout": [],
        "formData": {},
        "rules": {}
      }
- model: plugin.pluginform
  fields:
    language: en
    type:
    - bk-ip-restriction
    notes: |-
      This plugin allows you to restrict access to a Resource by either whitelisting or blacklisting IP addresses.
      Single IPs, multiple IPs or even IP ranges in CIDR notation like 1.1.1.0/24 can be used.
      One piece of data per line, and supports blank lines and comment lines (beginning with #).
    example: "Function: Only IP 192.168.1.1 and 192.168.1.1 are allowed to request the current interface\n\nType: whitelist\nWhitelist: # comment\n       192.168.1.1\n       192.168.1.2"
    style: dynamic
    default_value: ''
    config: |-
      {
        "schema": {
          "type": "object",
          "oneOf": [
            {
              "required": [
                "whitelist"
              ],
              "title": "White list",
              "properties": {
                "whitelist": {
                  "type": "string",
                  "maxLength": 51200,
                  "minLength": 7,
                  "title": "whitelist",
                  "ui:component": {
                    "type": "textarea",
                    "rows": 10
                  }
                }
              }
            },
            {
              "required": [
                "blacklist"
              ],
              "title": "Black list",
              "properties": {
                "blacklist": {
                  "type": "string",
                  "maxLength": 51200,
                  "minLength": 7,
                  "title": "blacklist",
                  "ui:component": {
                    "type": "textarea",
                    "rows": 10
                  }
                }
              }
            }
          ],
          "ui:oneOf": {
            "title": "Type"
          }
        },
        "layout": [],
        "formData": {},
        "rules": {}
      }
- model: schema.schema
  fields:
    created_time: 2023-04-26 14:54:21.010753+00:00
    updated_time: 2023-04-26 14:54:21.010753+00:00
    name: bk-rate-limit
    type: plugin
    version: '0'
    _schema: |-
      {
        "properties": {
          "rates": {
            "additionalProperties": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "period": {
                    "type": "integer"
                  },
                  "tokens": {
                    "type": "integer"
                  }
                }
              }
            },
            "type": "object"
          },
          "_meta": {
            "properties": {
              "priority": {
                "description": "priority of plugins by customized order",
                "type": "integer"
              },
              "disable": {
                "type": "boolean"
              },
              "error_response": {
                "oneOf": [
                  {
                    "type": "string"
                  },
                  {
                    "type": "object"
                  }
                ]
              },
              "filter": {
                "description": "filter determines whether the plugin needs to be executed at runtime",
                "type": "array"
              }
            },
            "type": "object"
          }
        },
        "$comment": "this is a mark for our injected plugin schema",
        "type": "object"
      }
    description: '-'
    example: '-'
- model: plugin.plugintype
  fields:
    code: bk-rate-limit
    name: 频率控制
    name_en: Rate Limit
    is_public: true
    scope: stage_and_resource
    schema:
    - bk-rate-limit
    - plugin
    - '0'
- model: plugin.pluginform
  fields:
    language: ''
    type:
    - bk-rate-limit
    notes: |-
      默认频率限制，表示单个应用的默认频率限制；特殊应用频率限制，对指定应用设置单独的频率限制。频率控制插件，在环境上配置表示对应用访问环境下所有资源的总访问频率进行限制，
      在资源上配置，表示对应用访问单个资源的频率进行限制， 如果在环境和资源上都配置，两个都会生效，先校验资源的频率限制，再校验环境的频率限制。
    example: "作用：默认每个应用 100 次/秒，应用demo 200 次/秒\n\n默认频率限制： 次数: 100 时间范围: 秒\n特殊应用频率限制： 次数: 200  时间范围: 秒  蓝鲸应用ID: demo"
    style: dynamic
    default_value: ''
    config: |-
      {
        "schema": {
          "title": "频率控制",
          "type": "object",
          "properties": {
            "rates": {
              "type": "object",
              "properties": {
                "default": {
                  "type": "object",
                  "title": "默认频率限制",
                  "ui:group": {
                    "type": "card",
                    "showTitle": true,
                    "style": {
                      "background": "#F5F7FA",
                      "padding": "10px 20px 10px 16px"
                    }
                  },
                  "required": [
                    "tokens",
                    "period"
                  ],
                  "properties": {
                    "tokens": {
                      "type": "integer",
                      "title": "次数",
                      "default": 100,
                      "ui:rules": [
                        "required"
                      ],
                      "ui:component": {
                        "name": "bfInput",
                        "min": 1
                      },
                      "ui:props": {
                        "labelWidth": 100
                      }
                    },
                    "period": {
                      "type": "integer",
                      "title": "时间范围",
                      "default": 1,
                      "ui:rules": [
                        "required"
                      ],
                      "ui:component": {
                        "name": "select",
                        "datasource": [
                          {
                            "label": "秒",
                            "value": 1
                          },
                          {
                            "label": "分",
                            "value": 60
                          },
                          {
                            "label": "时",
                            "value": 3600
                          },
                          {
                            "label": "天",
                            "value": 86400
                          }
                        ],
                        "clearable": false
                      },
                      "ui:props": {
                        "labelWidth": 100
                      }
                    }
                  }
                },
                "specials": {
                  "type": "array",
                  "title": "特殊应用频率限制",
                  "ui:group": {
                    "type": "card",
                    "showTitle": true,
                    "style": {
                      "background": "#F5F7FA",
                      "padding": "10px 20px 20px 16px"
                    }
                  },
                  "items": {
                    "type": "object",
                    "required": [
                      "tokens",
                      "period",
                      "bk_app_code"
                    ],
                    "ui:group": {
                      "style": {
                        "background": "#FFF",
                        "padding": "10px 10px 10px 10px"
                      }
                    },
                    "properties": {
                      "tokens": {
                        "type": "integer",
                        "title": "次数",
                        "default": 1,
                        "ui:rules": [
                          "required"
                        ],
                        "ui:component": {
                          "name": "bfInput",
                          "min": 1
                        },
                        "ui:props": {
                          "labelWidth": 90
                        }
                      },
                      "period": {
                        "type": "integer",
                        "title": "时间范围",
                        "default": 1,
                        "ui:rules": [
                          "required"
                        ],
                        "ui:component": {
                          "name": "select",
                          "datasource": [
                            {
                              "label": "秒",
                              "value": 1
                            },
                            {
                              "label": "分",
                              "value": 60
                            },
                            {
                              "label": "时",
                              "value": 3600
                            },
                            {
                              "label": "天",
                              "value": 86400
                            }
                          ],
                          "clearable": false
                        },
                        "ui:props": {
                          "labelWidth": 100
                        }
                      },
                      "bk_app_code": {
                        "type": "string",
                        "title": "蓝鲸应用 ID",
                        "pattern": "^[a-z][a-z0-9_-]{0,31}$",
                        "ui:rules": [
                          "required"
                        ],
                        "ui:props": {
                          "labelWidth": 100
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "layout": [
          [
            {
              "prop": "rates",
              "group": [
                [
                  {
                    "prop": "default",
                    "container": {
                      "grid-template-columns": "250px 200px"
                    },
                    "group": [
                      [
                        "tokens",
                        "period"
                      ]
                    ]
                  }
                ],
                [
                  {
                    "prop": "specials",
                    "container": {
                      "grid-template-columns": "250px 200px 250px"
                    },
                    "group": [
                      [
                        "tokens",
                        "period",
                        "bk_app_code"
                      ]
                    ]
                  }
                ]
              ]
            }
          ]
        ],
        "formData": {},
        "rules": {}
      }
- model: plugin.pluginform
  fields:
    language: en
    type:
    - bk-rate-limit
    notes: The default rate limit indicates the default rate limit for a single app;
      the special app rate limit sets a separate rate limit for a specified app. Rate
      Limit plugin, when binding a stage, indicates the total rate limit of all resources
      in the stage by the app; when binding a resource, indicates the rate limit of
      an app on the single resource.
    example: "Function: By default, each application is performed 100 times/second, and demo is performed 200 times/second\n\nDefault frequency limit: Times: 100 Time range: seconds\nSpecial application frequency limit: Times: 200  Time range: seconds Blue  Whale application ID: demo"
    style: dynamic
    default_value: ''
    config: |-
      {
        "schema": {
          "title": "Rate Limit",
          "type": "object",
          "properties": {
            "rates": {
              "type": "object",
              "properties": {
                "default": {
                  "type": "object",
                  "title": "Default Rate Limit",
                  "ui:group": {
                    "type": "card",
                    "showTitle": true,
                    "style": {
                      "background": "#F5F7FA",
                      "padding": "10px 20px 10px 16px"
                    }
                  },
                  "required": [
                    "tokens",
                    "period"
                  ],
                  "properties": {
                    "tokens": {
                      "type": "integer",
                      "title": "Count",
                      "default": 100,
                      "ui:rules": [
                        "required"
                      ],
                      "ui:component": {
                        "name": "bfInput",
                        "min": 1
                      },
                      "ui:props": {
                        "labelWidth": 100
                      }
                    },
                    "period": {
                      "type": "integer",
                      "title": "Time Range",
                      "default": 1,
                      "ui:rules": [
                        "required"
                      ],
                      "ui:component": {
                        "name": "select",
                        "datasource": [
                          {
                            "label": "Second",
                            "value": 1
                          },
                          {
                            "label": "Minute",
                            "value": 60
                          },
                          {
                            "label": "Hour",
                            "value": 3600
                          },
                          {
                            "label": "Day",
                            "value": 86400
                          }
                        ],
                        "clearable": false
                      },
                      "ui:props": {
                        "labelWidth": 100
                      }
                    }
                  }
                },
                "specials": {
                  "type": "array",
                  "title": "Special Apps Rate Limit",
                  "ui:group": {
                    "type": "card",
                    "showTitle": true,
                    "style": {
                      "background": "#F5F7FA",
                      "padding": "10px 20px 20px 16px"
                    }
                  },
                  "items": {
                    "type": "object",
                    "required": [
                      "tokens",
                      "period",
                      "bk_app_code"
                    ],
                    "ui:group": {
                      "style": {
                        "background": "#FFF",
                        "padding": "10px 10px 10px 10px"
                      }
                    },
                    "properties": {
                      "tokens": {
                        "type": "integer",
                        "title": "Count",
                        "default": 1,
                        "ui:rules": [
                          "required"
                        ],
                        "ui:component": {
                          "name": "bfInput",
                          "min": 1
                        },
                        "ui:props": {
                          "labelWidth": 90
                        }
                      },
                      "period": {
                        "type": "integer",
                        "title": "Time Range",
                        "default": 1,
                        "ui:rules": [
                          "required"
                        ],
                        "ui:component": {
                          "name": "select",
                          "datasource": [
                            {
                              "label": "Second",
                              "value": 1
                            },
                            {
                              "label": "Minute",
                              "value": 60
                            },
                            {
                              "label": "Hour",
                              "value": 3600
                            },
                            {
                              "label": "Day",
                              "value": 86400
                            }
                          ],
                          "clearable": false
                        },
                        "ui:props": {
                          "labelWidth": 100
                        }
                      },
                      "bk_app_code": {
                        "type": "string",
                        "title": "App Id",
                        "pattern": "^[a-z][a-z0-9_-]{0,31}$",
                        "ui:rules": [
                          "required"
                        ],
                        "ui:props": {
                          "labelWidth": 100
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "layout": [
          [
            {
              "prop": "rates",
              "group": [
                [
                  {
                    "prop": "default",
                    "container": {
                      "grid-template-columns": "250px 200px"
                    },
                    "group": [
                      [
                        "tokens",
                        "period"
                      ]
                    ]
                  }
                ],
                [
                  {
                    "prop": "specials",
                    "container": {
                      "grid-template-columns": "250px 200px 250px"
                    },
                    "group": [
                      [
                        "tokens",
                        "period",
                        "bk_app_code"
                      ]
                    ]
                  }
                ]
              ]
            }
          ]
        ],
        "formData": {},
        "rules": {}
      }
- model: plugin.plugintype
  fields:
    code: bk-status-rewrite
    name: 网关错误使用HTTP状态码200(不推荐)
    name_en: Gateway error using HTTP status code 200 (not recommended)
    is_public: false
    schema: null
- model: plugin.pluginform
  fields:
    language: ''
    type:
      - bk-status-rewrite
    notes: Gateway error using HTTP status code 200 (not recommended)
    style: dynamic
    default_value: ''
    config: |-
      {
        "schema": {},
        "layout": [],
        "formData": {},
        "rules": {}
      }
- model: schema.schema
  fields:
    created_time: 2023-02-02 14:54:21.010753+00:00
    updated_time: 2023-02-02 14:54:21.010788+00:00
    name: bk-verified-user-exempted-apps
    type: plugin
    version: '0'
    _schema: |-
      {
        "properties": {
          "_meta": {
            "properties": {
              "disable": {
                "type": "boolean"
              },
              "error_response": {
                "oneOf": [
                  {
                    "type": "string"
                  },
                  {
                    "type": "object"
                  }
                ]
              },
              "priority": {
                "type": "integer",
                "description": "priority of plugins by customized order"
              },
              "filter": {
                "type": "array",
                "description": "filter determines whether the plugin needs to be executed at runtime"
              }
            },
            "type": "object"
          },
          "exempted_apps": {
            "items": {
              "properties": {
                "dimension": {
                  "type": "string"
                },
                "bk_app_code": {
                  "type": "string"
                },
                "resource_ids": {
                  "items": {
                    "type": "integer"
                  },
                  "type": "array"
                }
              },
              "type": "object"
            },
            "type": "array"
          }
        },
        "type": "object",
        "required": [
          "exempted_apps"
        ],
        "$comment": "this is a mark for our injected plugin schema"
      }
    description: '-'
    example: '-'
- model: plugin.plugintype
  fields:
    code: bk-verified-user-exempted-apps
    name: 免用户认证应用白名单(不推荐)
    name_en: Exempted user auth apps white list (not recommended)
    is_public: false
    scope: stage
    schema:
    - bk-verified-user-exempted-apps
    - plugin
    - '0'
- model: schema.schema
  fields:
    created_time: 2024-09-03 15:32:21.010753+00:00
    updated_time: 2024-09-03 15:32:21.010753+00:00
    name: bk-mock
    type: plugin
    version: '0'
    _schema: |-
      {
        "$comment": "this is a mark for our injected plugin schema",
        "type": "object",
        "properties": {
          "response_status":{
              "type": "integer",
              "default": 200,
              "minimum": 100
          },
          "response_example": {
              "type": "string"
          },
          "response_headers": {
              "type": "object"
          }
        }
      }
    description: '-'
    example: '-'
- model: plugin.plugintype
  fields:
    code: bk-mock
    name: mocking
    name_en: mocking
    is_public: true
    scope: resource
    schema:
    - bk-mock
    - plugin
    - '0'
- model: plugin.pluginform
  fields:
    language: ''
    type:
    - bk-mock
    notes: 支持模拟 API 响应，返回指定格式，并且请求不会转发到上游。
    example: '作用：返回json response，状态码为 200，并且携带响应头foo:bar\n\n响应状态码: 200\n响应体: {"hello": "world"}\n响应头: Content-Type: application/json\n       foo: bar'
    style: dynamic
    default_value: ''
    config: |-  
      {  
        "schema": {  
          "type": "object",  
          "properties": {  
            "response_status": {  
              "type": "integer",  
              "default": 200,  
              "title": "响应状态码",  
              "minimum": 100  
            },  
            "response_example": {  
              "title": "响应体",  
              "type": "string",  
              "ui:component": {  
                "type": "textarea",  
                "rows": 10  
              }  
            },  
            "response_headers": {  
              "description": "设置响应头",  
              "items": {  
                "properties": {  
                  "key": {  
                    "title": "键",  
                    "description": "You can set the key of the request header. The key of the request header cannot contain a colon (:).",  
                    "type": "string",  
                    "maxLength": 1024,  
                    "pattern": "^[\\w-]+$",  
                    "ui:rules": ["required"]  
                  },  
                  "value": {  
                    "title": "值",  
                    "description": "You can set the value of the request header.",  
                    "type": "string",  
                    "maxLength": 1024,  
                    "pattern": "^[\\s\\S]*$",  
                    "ui:rules": ["required"]  
                  }  
                },  
                "type": "object"  
              },  
              "minItems": 0,  
              "title": "响应头",  
              "type": "array",  
              "ui:component": {  
                "name": "bfArray"  
              }  
            }  
          }  
        },  
        "layout": [],  
        "formData": {},  
        "rules": {}  
      }
- model: plugin.pluginform
  fields:
    language: 'en'
    type:
    - bk-mock
    notes: for mocking an API, it returns data in the format specified and the request is not forwarded to the Upstream.
    example: 'Functions: Return json response with status code 200 and response header foo:bar\n\n Response status code: 200\n Response body: {"hello": "world"}\n Response header: Content-Type: application/json\n       foo: bar'
    style: dynamic
    default_value: ''
    config: |-
      {  
        "schema": {
          "type": "object",
          "properties": {
            "response_status": {
              "type": "integer",
              "default": 200,
              "title": "response_status",
              "minimum": 100
            },
            "response_example": {
              "title": "response_example",
              "type": "string",
              "ui:component": {
                "type": "textarea",
                "rows": 10
              }
            },
            "response_headers": {
              "description": "Set the response headers",
              "title": "response_headers",
              "type": "array",
              "ui:component": {
                "name": "bfArray"
              },
              "items": {
                "properties": {
                  "key": {
                    "title": "key",
                    "description": "You can set the key of the response header. The key of the response header cannot contain a colon (:).",
                    "type": "string",
                    "maxLength": 1024,
                    "pattern": "^[\\w-]+$",
                    "ui:rules": ["required"]
                  },
                  "value": {
                    "title": "value",
                    "description": "You can set the value of the response header.",
                    "type": "string",
                    "maxLength": 1024,
                    "pattern": "^[\\s\\S]*$",
                    "ui:rules": ["required"]
                  }
                },
                "type": "object"
              }
            }
          }
        },
        "layout": [],
        "formData": {},
        "rules": {}
      }
- model: schema.schema
  fields:
    created_time: 2024-09-10 11:48:21.010753+00:00
    updated_time: 2024-09-10 11:48:21.010788+00:00
    name: api-breaker
    type: plugin
    version: '0'
    _schema: |-
      {
        "$comment": "this is a mark for our injected plugin schema",
        "type": "object",
        "properties": {
          "break_response_code": {
            "type": "integer",
            "minimum": 200,
            "maximum": 599
          },
          "break_response_body": {
            "type": "string"
          },
          "break_response_headers": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "key": {
                  "type": "string",
                  "minLength": 1
                },
                "value": {
                  "type": "string",
                  "minLength": 1
                }
              },
              "required": ["key","value"]
            }
          },
          "max_breaker_sec": {
            "type": "integer",
            "minimum": 3,
            "default": 300
          },
          "unhealthy": {
            "type": "object",
            "properties": {
              "http_statuses": {
                "type": "array",
                "minItems": 1,
                "items": {
                  "type": "integer",
                  "minimum": 500,
                  "maximum": 599
                },
                "uniqueItems": true,
                "default": 500
              },
              "failures": {
                "type": "integer",
                "minimum": 1,
                "default": 3
              }
            },
            "default": {"http_statuses": [500], "failures": 3}
          },
          "healthy": {
            "type": "object",
            "properties": {
              "http_statuses": {
                "type": "array",
                "minItems": 0,
                "items": {
                  "type": "integer",
                  "minimum": 200,
                  "maximum": 499
                },
                "uniqueItems": true,
                "default": 200
              },
              "successes": {
                "type": "integer",
                "minimum": 1,
                "default": 3
              }
            },
            "default": {"http_statuses": [200] , "successes": 3}
          }
        },
        "required": ["break_response_code"]
      }
    description: '-'
    example: '-'
- model: plugin.plugintype
  fields:
    code: api-breaker
    name: 熔断
    name_en: Circuit Breaker
    is_public: true
    scope: resource
    schema:
    - api-breaker
    - plugin
    - '0'
- model: plugin.pluginform
  fields:
    language: ''
    type:
    - api-breaker
    notes: API 熔断是根据监测服务的响应时间或错误率来自动的触发熔断机制。一旦这些指标超过预设的阈值，熔断机制将自动启动，迅速终止对故障服务的请求，直至该服务恢复正常。
    example: '作用： 当上游服务返回状态码500的时候，并达到预设次数3次时，则认为上游服务处于不健康状态。当上游状态处于不健康状态的时候，返回json response，状态码为555，并且携带响应头foo:bar。\n第一次触发不健康状态时，熔断 2 秒。超过熔断时间后，将重新开始转发请求到上游服务，如果继续返回555状态码，当记数再次达到预设次数3次时，熔断 4 秒。依次类推（2，4，8，16，……），直到达到预设的最大熔断时间300秒。\n当上游服务处于不健康状态时，如果转发请求到上游服务并返回状态码200，并达到4次时，则认为上游服务恢复至健康状态。\n\nbreak_response_body： {"hello": "world"}\nbreak_response_headers： [ { "key": "foo", "value": "bar" } ]\nmax_breaker_sec： 300\nunhealthy： { "http_statuses": [ 500 ], "failures": 3 }\nhealthy： { "http_statuses": [ 200 ], "successes": 3 }\nbreak_response_code： 555'
    style: dynamic
    default_value: ''
    config: |-
      {
        "schema": {
          "type": "object",
          "required": [
            "break_response_code"
          ],
          "properties": {
            "break_response_code": {
              "description": "当上游服务处于不健康状态时返回的 HTTP 错误码。",
              "title": "熔断响应状态码",
              "type": "integer",
              "default": 502,
              "ui:rules": ["required"]
            },
            "break_response_body": {
              "description": "当上游服务处于不健康状态时返回的 HTTP 响应体信息。",
              "title": "熔断响应体",
              "type": "string",
              "ui:component": {
                "type": "textarea",
                "rows": 10
              }
            },
            "break_response_headers": {
              "description": "当上游服务处于不健康状态时返回的 HTTP 响应头信息。",
              "type": "array",
              "minItems": 0,
              "title": "熔断响应头",
              "ui:component": {
                "name": "bfArray"
              },  
              "items": {
                "type": "object",
                "properties": {
                  "key": {
                    "title": "键",
                    "description": "您可以设置响应头的键，请求头的键中不能包含冒号（:）。",
                    "type": "string",
                    "maxLength": 1024,
                    "pattern": "^[\\w-]+$",
                    "ui:rules": ["required"]
                  },
                  "value": {
                    "title": "值",
                    "description": "您可以设置响应头的值，请求头的键中不能包含冒号（:）。",
                    "type": "string",
                    "maxLength": 1024,
                    "pattern": "^[\\s\\S]*$",
                    "ui:rules": ["required"]
                  }
                }
              }
            },
            "max_breaker_sec": {
              "description": "上游服务熔断的最大持续时间，以秒为单位，最小 3 秒。",
              "title": "最大熔断时间",
              "type": "integer",
              "default": 300,
              "ui:component": {
                "name": "bfInput",
                "min": 3
              }
            },
            "unhealthy": {
              "description": "当上游服务处于不健康状态时的HTTP的状态码和异常请求次数.",
              "title": "不健康状态",
              "type": "object",
              "properties": {
                "http_statuses": {
                  "type": "array",
                  "title": "不健康状态码",
                  "minItems": 1,
                  "description": "上游服务处于不健康状态时的 HTTP 状态码。",
                  "items": {  
                    "type": "integer",
                    "default": 500,
                    "ui:component": {
                      "name": "bfInput",
                      "min": 500,
                      "max": 599
                    }
                  },
                  "ui:component": {
                    "name": "bfArray"
                  }
                },
                "failures": {
                  "description": "上游服务在一定时间内触发不健康状态的异常请求次数。",
                  "title": "不健康次数",
                  "type": "integer",
                  "default": 3,
                  "ui:component": {
                    "name": "bfInput",
                    "min": 1
                  }
                }
              }
            },
            "healthy": {
              "description": "上游服务处于健康状态时的 HTTP 状态码和连续正常请求次数。",
              "title": "健康状态",
              "type": "object",
              "properties": {
                "http_statuses": {
                  "type": "array",
                  "title": "健康状态码",
                  "minItems": 1,
                  "description": "上游服务处于健康状态时的 HTTP 状态码。",
                  "items": {
                    "type": "integer",
                    "default": 200,
                    "ui:component": {
                      "name": "bfInput",
                      "min": 200,
                      "max": 499
                    }
                  },
                  "ui:component": {
                    "name": "bfArray"
                  }
                },
                "successes": {
                  "description": "上游服务触发健康状态的连续正常请求次数。",
                  "title": "健康次数",
                  "type": "integer",
                  "default": 3,
                  "ui:component": {
                    "name": "bfInput",
                    "min": 1
                  }
                }
              }
            }
          }
        },
        "layout": [],
        "formData": {},
        "rules": {}
      }
- model: plugin.pluginform
  fields:
    language: en
    type:
    - api-breaker
    notes: API circuit breakers automatically trigger circuit breakers based on the response time or error rate of the monitoring service. Once these indicators exceed the preset threshold, the circuit breaker will automatically activate, quickly terminating the request for the faulty service until the service returns to normal.
    example: 'Function: When the upstream service returns the status code 500 and reaches the preset number of 3 times, the upstream service is considered to be in an unhealthy state. When the upstream state is unhealthy, return json response with status code 555 and response header foo:bar. When the unhealthy state is triggered for the first time, fuse for 2 seconds. After the fuse time is exceeded, the request will be forwarded to the upstream service again. If the 555 status code continues to be returned, the fuse will be broken for 4 seconds when the count reaches the preset number of 3 times again. And so on (2,4,8,16,...) Until the preset maximum fuse break time of 300 seconds is reached. When the upstream service is in an unhealthy state, if the request is forwarded to the upstream service and the status code 200 is returned for 4 times, the upstream service is considered to be restored to a healthy state. \n\nbreak_response_body: {"hello": "world"}\nbreak_response_headers: [{"key": "foo", "value": "bar"}]\nmax_breaker_sec: 300\nunhealthy: {"http_statuses": [500], "failures": 3}\nhealthy: {"http_statuses": [200], "successes": 3}\nbreak_response_code: 555'
    style: dynamic
    default_value: ''
    config: |-
      {
        "schema": {
          "type": "object",
          "required": [
            "break_response_code"
          ],
          "properties": {
            "break_response_code": {
              "description": "HTTP error code returned when the upstream service is in an unhealthy state.",
              "title": "Fuse response status code",
              "default": 502,
              "type": "integer",
              "ui:rules": ["required"]
            },
            "break_response_body": {
              "description": "HTTP response body information returned when the upstream service is in an unhealthy state.",
              "title": "Fuse response body",
              "type": "string",
              "ui:component": {
                "type": "textarea",
                "rows": 10
              }
            },
            "break_response_headers": {
              "description": "The HTTP response header returned when the upstream service is in an unhealthy state.",
              "type": "array",
              "minItems": 0,
              "title": "Fuse response head",
              "ui:component": {
                "name": "bfArray"
              },  
              "items": {
                "type": "object",
                "properties": {
                  "key": {
                    "title": "key",
                    "description": "You can set the key of the response header. The key of the request header cannot contain a colon (:).",
                    "type": "string",
                    "maxLength": 1024,
                    "pattern": "^[\\w-]+$",
                    "ui:rules": ["required"]
                  },
                  "value": {
                    "title": "value",
                    "description": "You can set the value of the response header, and the key of the request header cannot contain a colon (:).",
                    "type": "string",
                    "maxLength": 1024,
                    "pattern": "^[\\s\\S]*$",
                    "ui:rules": ["required"]
                  }
                }
              }
            },
            "max_breaker_sec": {
              "description": "The maximum duration of the upstream service meltdown, in seconds. The minimum duration is 3 seconds.",
              "title": "Maximum fusing time",
              "type": "integer",
              "default": 300,
              "ui:component": {
                "name": "bfInput",
                "min": 3
              }
            },
            "unhealthy": {
              "description": "HTTP status code and number of abnormal requests when the upstream service is in an unhealthy state.",
              "title": "Unhealthy state",
              "type": "object",
              "properties": {
                "http_statuses": {
                  "type": "array",
                  "title": "Unhealthy status code",
                  "minItems": 1,
                  "description": "HTTP status code when the upstream service is in unhealthy state.",
                  "items": {  
                    "type": "integer",
                    "default": 500,
                    "ui:component": {
                      "name": "bfInput",
                      "min": 500,
                      "max": 599
                    }
                  },
                  "ui:component": {
                    "name": "bfArray"
                  }
                },
                "failures": {
                  "description": "Number of unhealthy requests triggered by the upstream service within a certain period.",
                  "title": "Unhealthy times",
                  "type": "integer",
                  "default": 3,
                  "ui:component": {
                    "name": "bfInput",
                    "min": 1
                  }
                }
              }
            },
            "healthy": {
              "description": "HTTP status code and number of consecutive normal requests when the upstream service is in the health state.",
              "title": "Health state",
              "type": "object",
              "properties": {
                "http_statuses": {
                  "type": "array",
                  "title": "Health status code",
                  "minItems": 1,
                  "description": "HTTP status code when the upstream service is in the healthy state.",
                  "items": {
                    "type": "integer",
                    "default": 200,
                    "ui:component": {
                      "name": "bfInput",
                      "min": 200,
                      "max": 499
                    }
                  },
                  "ui:component": {
                    "name": "bfArray"
                  }
                },
                "successes": {
                  "description": "Number of consecutive normal requests that the upstream service triggers the health status.",
                  "title": "Healthy number",
                  "type": "integer",
                  "default": 3,
                  "ui:component": {
                    "name": "bfInput",
                    "min": 1
                  }
                }
              }
            }
          }
        },
        "layout": [],
        "formData": {},
        "rules": {}
      }
- model: schema.schema
  fields:
    created_time: 2024-09-03 15:32:21.010753+00:00
    updated_time: 2024-09-03 15:32:21.010753+00:00
    name: request-validation
    type: plugin
    version: '0'
    _schema: |-
      {  
        "$schema": "http://json-schema.org/draft-07/schema#",  
        "title": "MetaDataSchema",  
        "type": "object",  
        "properties": {  
          "header_schema": {  
            "type": "object",  
            "description": "header 数据的 schema 数据结构。",  
            "additionalProperties": true  
          },  
          "body_schema": {  
            "type": "object",  
            "description": "body 数据的 schema 数据结构。",  
            "additionalProperties": true  
          },  
          "rejected_code": {  
            "type": "integer",  
            "description": "当请求被拒绝时要返回的状态码。",  
            "default": 400,  
            "minimum": 200,  
            "maximum": 599  
          },  
          "rejected_msg": {  
            "type": "string",  
            "description": "当请求被拒绝时返回的信息。"  
          }  
        },  
        "anyOf": [  
          { "required": ["header_schema"] },  
          { "required": ["body_schema"] }  
        ],  
        "required": []
      }
    description: '-'
    example: '-'
- model: plugin.plugintype
  fields:
    code: request-validation
    name: 请求校验
    name_en: request_validation
    is_public: true
    scope: stage
    schema:
    - request-validation
    - plugin
    - '0'
- model: plugin.pluginform
  fields:
    language: ''
    type:
    - request-validation
    notes: request-validation 插件用于提前验证向上游服务转发的请求。该插件使用 JSON Schema 机制进行数据验证，可以验证请求的 Body 以及 Header 的数据。
    example: '作用： 当请求时没有填入boolean_payload为 True 参数，则返回 400 拒绝状态码和 foo 拒绝信息\n\n"header_schema": {}\n"body_schema": {"type": "object","required": ["bool_payload"],"properties": {"bool_payload": {"type": "boolean","default": true}}}\n"rejected_code": 400\n"rejected_msg": "foo"'
    style: dynamic
    default_value: ''
    config: |-  
      {
        "schema": {
          "type": "object",
          "properties": {
            "header_schema": {
              "type": "string",
              "maxLength": 51200,
              "title": "请求头概要",
              "description": "header 数据的 schema 数据结构",
              "ui:component": {
                "type": "textarea",
                "rows": 10
              }
            },              
            "body_schema": {
              "type": "string",
              "maxLength": 51200,
              "title": "请求体概要",
              "description": "body 数据的 schema 数据结构",
              "ui:component": {
                "type": "textarea",
                "rows": 10
              }
            },
            "rejected_code": {
              "type": "integer",
              "default": 400,
              "title": "拒绝状态码",
              "minimum": 200
            },
            "rejected_msg": {
              "title": "拒绝信息",
              "type": "string",
              "ui:component": {
                "type": "textarea",
                "rows": 10
              }
            }
          } 
        },
        "layout": [],
        "formData": {},
        "rules": {}
      }
- model: plugin.pluginform
  fields:
    language: 'en'
    type:
    - request-validation
    notes: The request-validation plug-in is used to validate requests forwarded to upstream services in advance. The plug-in uses the JSON Schema mechanism for data validation, which validates the requested Body and Header data.
    example: 'Functions: When the boolean_payload argument is not filled as True at the time of the request, 400 reject status code and foo reject information are returned \n\n"header_schema": {}\n"body_schema": {"type": "object","required": ["bool_payload"],"properties": {"bool_payload": {"type": "boolean","default": true}}}\n"rejected_code": 400\n"rejected_msg": "foo"'
    style: dynamic
    default_value: ''
    config: |-
      {
        "schema": {
          "type": "object",
          "properties": {
            "header_schema": {
              "type": "string",
              "maxLength": 51200,
              "title": "header_schema",
              "description": "header data schema data structure.",
              "ui:component": {
                "type": "textarea",
                "rows": 10
              }
            },              
            "body_schema": {
              "type": "string",
              "maxLength": 51200,
              "description": "body data schema data structure.",
              "title": "body_schema",
              "ui:component": {
                "type": "textarea",
                "rows": 10
              }
            },
            "rejected_code": {
              "type": "integer",
              "default": 400,
              "title": "rejected_code",
              "minimum": 200
            },
            "rejected_msg": {
              "title": "rejected_msg",
              "type": "string",
              "ui:component": {
                "type": "textarea",
                "rows": 10
              }
            }
          } 
        },
        "layout": [],
        "formData": {},
        "rules": {}
      }