openapi: 3.0.1
servers:
- url: /
info:
  version: '2.0'
  title: API Gateway Resources
  description: ''
paths:
  /api/v1/apis/:
    get:
      operationId: get_apis
      description: 查询网关列表
      tags:
      - v1
      responses:
        '200':
          description: 成功返回网关列表
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    description: 返回码，0 表示成功
                    example: 0
                  message:
                    type: string
                    description: 错误信息
                    example: OK
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          description: 网关ID
                          example: 1
                        name:
                          type: string
                          description: 网关名称
                          example: bk-apigateway
                        description:
                          type: string
                          description: 网关描述
                          example: 蓝鲸API网关
                        maintainers:
                          type: array
                          items:
                            type: string
                          description: 网关管理员
                          example: ["admin"]
              example:
                code: 0
                message: OK
                data:
                  - id: 1
                    name: bk-apigateway
                    description: ""
                    maintainers: ["admin"]
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: true
        matchSubpath: false
        enableWebsocket: false
        noneSchema: true
        backend:
          name: default
          method: get
          path: /backend/api/v1/apis/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: true
        descriptionEn: Query gateway list
  /api/v1/apis/{api_name}/permissions/apply/:
    post:
      operationId: apply_permissions
      description: 申请网关API访问权限
      tags:
      - v1
      parameters:
        - name: api_name
          in: path
          required: true
          schema:
            type: string
          description: 网关名
          example: demo
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - target_app_code
                - grant_dimension
              properties:
                target_app_code:
                  type: string
                  description: 申请权限的应用，应于当前请求的应用一致
                  example: my-app
                expire_days:
                  type: integer
                  description: 过期时间，0 或未提供表示永久，180 表示 6 个月，360 表示 12 个月
                  example: 360
                grant_dimension:
                  type: string
                  description: 授权维度，api 表示按网关申请权限
                  enum:
                    - api
                  example: api
                reason:
                  type: string
                  description: 申请原因
                  example: test
            example:
              target_app_code: my-app
              expire_days: 360
              grant_dimension: api
              reason: test
      responses:
        '200':
          description: 成功返回申请记录ID
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 0
                  message:
                    type: string
                    example: OK
                  data:
                    type: object
                    properties:
                      record_id:
                        type: integer
                        description: 权限申请单的单据ID
                        example: 12345
              example:
                code: 0
                message: OK
                data:
                  record_id: 12345
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: true
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: post
          path: /backend/api/v1/apis/{api_name}/permissions/apply/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: false
        descriptionEn: Apply for gateway API access permission
  /api/v1/apis/{api_name}/permissions/grant/:
    post:
      operationId: grant_permissions
      description: 网关为应用主动授权
      tags:
      - v1
      parameters:
        - name: api_name
          in: path
          required: true
          schema:
            type: string
          description: 网关名
          example: demo
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - target_app_code
                - grant_dimension
              properties:
                target_app_code:
                  type: string
                  description: 待授权应用
                  example: bk-sops
                expire_days:
                  type: integer
                  description: 过期时间，单位天；0或不提供时表示永久权限
                  example: 360
                grant_dimension:
                  type: string
                  description: 授权维度，可选值：api(按网关授权)
                  enum:
                    - api
                  example: api
            example:
              target_app_code: bk-sops
              expire_days: 360
              grant_dimension: api
      responses:
        '200':
          description: 成功响应
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 0
                  message:
                    type: string
                    example: OK
                  data:
                    type: object
              example:
                code: 0
                message: OK
                data: {}
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: true
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: post
          path: /backend/api/v1/apis/{api_name}/permissions/grant/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: false
        descriptionEn: Grant permissions to application
  /api/v1/apis/{api_name}/permissions/revoke/:
    delete:
      operationId: revoke_permissions
      description: 回收应用访问网关 API 的权限
      tags:
      - v1
      parameters:
        - name: api_name
          in: path
          required: true
          schema:
            type: string
          description: 网关名
          example: demo
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - target_app_codes
                - grant_dimension
              properties:
                target_app_codes:
                  type: array
                  items:
                    type: string
                  description: 待回收权限的应用列表
                  example: ["my-app"]
                grant_dimension:
                  type: string
                  description: 授权维度，可选值：api(按网关授权)
                  enum:
                    - api
                  example: api
            example:
              target_app_codes: ["my-app"]
              grant_dimension: api
      responses:
        '200':
          description: 成功响应
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 0
                  message:
                    type: string
                    example: OK
                  data:
                    type: object
                    nullable: true
              example:
                code: 0
                message: OK
                data: null
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: true
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: delete
          path: /backend/api/v1/apis/{api_name}/permissions/revoke/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: false
        descriptionEn: Revoke application gateway API access permission
  /api/v1/apis/{api_name}/public_key/:
    get:
      operationId: get_apigw_public_key
      description: 获取网关公钥
      tags:
      - v1
      parameters:
        - name: api_name
          in: path
          required: true
          schema:
            type: string
          description: 网关名
          example: demo
      responses:
        '200':
          description: 成功返回网关公钥
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 0
                  message:
                    type: string
                    example: OK
                  data:
                    type: object
                    properties:
                      issuer:
                        type: string
                        description: 签发者
                        example: APIGW
                      public_key:
                        type: string
                        description: 网关公钥
                        example: "-----BEGIN PUBLIC KEY-----\nMIIBIjAN..."
              example:
                code: 0
                message: OK
                data:
                  issuer: ""
                  public_key: "xxx"
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: true
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: core-api
          method: get
          path: /api/v1/open/gateways/{api_name}/public_key/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: false
        descriptionEn: Get gateway public key

  /api/v2/mcp-servers/{mcp_server_name}/sse:
    get:
      operationId: mcp_proxy_sse
      description: mcp proxy sse接口
      tags:
        - v2_mcp
      responses:
        default:
          description: ''
          content:
            application/json:
              schema: { }
      x-bk-apigateway-resource:
        isPublic: false
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: mcp-proxy
          method: get
          path: /{mcp_server_name}/sse
          matchSubpath: false
          timeout: 0
        pluginConfigs:
        - type: bk-oauth2-protected-resource
          yaml: '{}'
        - type: bk-oauth2-verify
          yaml: '{}'
        - type: bk-oauth2-audience-validate
          yaml: '{}'
        authConfig:
          userVerifiedRequired: true
          appVerifiedRequired: true
          resourcePermissionRequired: false
        descriptionEn: None
  /api/v2/mcp-servers/{mcp_server_name}/sse/message:
    post:
      operationId: mcp_proxy_message
      description: mcp proxy message接口
      tags:
        - v2_mcp
      responses:
        default:
          description: ''
          content:
            application/json:
              schema: { }
      x-bk-apigateway-resource:
        isPublic: false
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: mcp-proxy
          method: post
          path: /{mcp_server_name}/sse/message
          matchSubpath: false
          timeout: 0
        pluginConfigs:
        - type: bk-oauth2-protected-resource
          yaml: '{}'
        - type: bk-oauth2-verify
          yaml: '{}'
        - type: bk-oauth2-audience-validate
          yaml: '{}'
        authConfig:
          userVerifiedRequired: true
          appVerifiedRequired: true
          resourcePermissionRequired: false
  /api/v2/mcp-servers/{mcp_server_name}/application/sse:
    get:
      operationId: mcp_proxy_application_sse
      description: mcp proxy sse(应用态)接口
      tags:
        - v2_mcp
      responses:
        default:
          description: ''
          content:
            application/json:
              schema: { }
      x-bk-apigateway-resource:
        isPublic: false
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: mcp-proxy
          method: get
          path: /{mcp_server_name}/application/sse
          matchSubpath: false
          timeout: 0
        pluginConfigs: [ ]
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: false
        descriptionEn: None
  /api/v2/mcp-servers/{mcp_server_name}/application/sse/message:
    post:
      operationId: mcp_proxy_application_message
      description: mcp proxy message(应用态)接口
      tags:
        - v2_mcp
      responses:
        default:
          description: ''
          content:
            application/json:
              schema: { }
      x-bk-apigateway-resource:
        isPublic: false
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: mcp-proxy
          method: post
          path: /{mcp_server_name}/application/sse/message
          matchSubpath: false
          timeout: 0
        pluginConfigs: [ ]
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: false
  /api/v2/mcp-servers/{mcp_server_name}/mcp:
    get:
      operationId: mcp_proxy_user_streamable_http_get
      description: mcp proxy streamableHTTP(用户态)接口
      tags:
        - v2_mcp
      responses:
        default:
          description: ''
          content:
            application/json:
              schema: { }
      x-bk-apigateway-resource:
        isPublic: false
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: mcp-proxy
          method: get
          path: /{mcp_server_name}/mcp
          matchSubpath: false
          timeout: 0
        pluginConfigs:
        - type: bk-oauth2-protected-resource
          yaml: '{}'
        - type: bk-oauth2-verify
          yaml: '{}'
        - type: bk-oauth2-audience-validate
          yaml: '{}'
        authConfig:
          userVerifiedRequired: true
          appVerifiedRequired: true
          resourcePermissionRequired: false
        descriptionEn: None
    post:
      operationId: mcp_proxy_user_streamable_http_post
      description: mcp proxy streamableHTTP(用户态)接口
      tags:
        - v2_mcp
      responses:
        default:
          description: ''
          content:
            application/json:
              schema: { }
      x-bk-apigateway-resource:
        isPublic: false
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: mcp-proxy
          method: post
          path: /{mcp_server_name}/mcp
          matchSubpath: false
          timeout: 0
        pluginConfigs:
        - type: bk-oauth2-protected-resource
          yaml: '{}'
        - type: bk-oauth2-verify
          yaml: '{}'
        - type: bk-oauth2-audience-validate
          yaml: '{}'
        authConfig:
          userVerifiedRequired: true
          appVerifiedRequired: true
          resourcePermissionRequired: false
        descriptionEn: None
  /api/v2/mcp-servers/{mcp_server_name}/application/mcp:
    post:
      operationId: mcp_proxy_app_streamable_http_post
      description: mcp proxy streamableHTTP(应用态)接口
      tags:
        - v2_mcp
      responses:
        default:
          description: ''
          content:
            application/json:
              schema: { }
      x-bk-apigateway-resource:
        isPublic: false
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: mcp-proxy
          method: post
          path: /{mcp_server_name}/application/mcp
          matchSubpath: false
          timeout: 0
        pluginConfigs: [ ]
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: false
    get:
      operationId: mcp_proxy_app_streamable_http_get
      description: mcp proxy streamableHTTP(应用态)接口
      tags:
        - v2_mcp
      responses:
        default:
          description: ''
          content:
            application/json:
              schema: { }
      x-bk-apigateway-resource:
        isPublic: false
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: mcp-proxy
          method: get
          path: /{mcp_server_name}/application/mcp
          matchSubpath: false
          timeout: 0
        pluginConfigs: [ ]
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: false
  /api/v1/apis/{api_name}/related-apps/:
    post:
      operationId: add_related_apps
      description: 添加网关关联应用
      tags:
      - v1
      parameters:
        - name: api_name
          in: path
          required: true
          schema:
            type: string
          description: 网关名
          example: demo
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - target_app_codes
              properties:
                target_app_codes:
                  type: array
                  items:
                    type: string
                  description: 目标应用列表
                  example: ["my-app"]
            example:
              target_app_codes: ["my-app"]
      responses:
        '200':
          description: 成功响应
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 0
                  message:
                    type: string
                    example: OK
                  data:
                    type: object
              example:
                code: 0
                message: OK
                data: {}
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: true
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: post
          path: /backend/api/v1/apis/{api_name}/related-apps/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: false
        descriptionEn: Add gateway related apps
  /api/v1/apis/{api_name}/released/stages/{stage_name}/resources/:
    get:
      operationId: get_released_resources
      description: 查询已发布资源列表
      tags:
      - v1
      parameters:
        - name: api_name
          in: path
          required: true
          schema:
            type: string
          description: 网关名
          example: demo
        - name: stage_name
          in: path
          required: true
          schema:
            type: string
          description: 环境名
          example: prod
      responses:
        '200':
          description: 成功返回已发布资源列表
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 0
                  message:
                    type: string
                    example: OK
                  data:
                    type: object
                    properties:
                      count:
                        type: integer
                        description: 资源数量
                        example: 2
                      has_next:
                        type: boolean
                        description: 分页，后续是否有数据
                        example: false
                      has_previous:
                        type: boolean
                        description: 分页，前面是否有数据
                        example: false
                      results:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: integer
                              example: 3
                            name:
                              type: string
                              example: echo
                            description:
                              type: string
                              example: ""
                            method:
                              type: string
                              example: GET
                            url:
                              type: string
                              example: "https://bkapi.example.com/api/echo/prod/echo/"
                            match_subpath:
                              type: boolean
                              example: false
                            enable_websocket:
                              type: boolean
                              example: false
                            app_verified_required:
                              type: boolean
                              example: false
                            resource_perm_required:
                              type: boolean
                              example: false
                            user_verified_required:
                              type: boolean
                              example: false
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: true
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: get
          path: /backend/api/v1/apis/{api_name}/released/stages/{stage_name}/resources/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: true
        descriptionEn: Query released resources list
  /api/v1/apis/{api_name}/released/stages/{stage_name}/resources/{resource_name}/:
    get:
      operationId: get_released_resource
      description: 查询发布资源详情(包含接口参数)
      tags:
      - v1
      parameters:
        - name: api_name
          in: path
          required: true
          schema:
            type: string
          description: 网关名
          example: demo
        - name: stage_name
          in: path
          required: true
          schema:
            type: string
          description: 环境名
          example: prod
        - name: resource_name
          in: path
          required: true
          schema:
            type: string
          description: 资源名称
          example: updatePet
      responses:
        '200':
          description: 成功返回资源详情
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 0
                  message:
                    type: string
                    example: OK
                  data:
                    type: object
                    properties:
                      id:
                        type: integer
                        description: 资源ID
                        example: 2448
                      name:
                        type: string
                        description: 资源名称
                        example: updatePet
                      method:
                        type: string
                        description: 资源请求方法
                        example: PUT
                      path:
                        type: string
                        description: 资源请求地址
                        example: /api/v3/pet
                      schema:
                        type: object
                        description: 资源协议数据（OpenAPI 3.0 格式）
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: true
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: get
          path: /backend/api/v1/apis/{api_name}/released/stages/{stage_name}/resources/{resource_name}/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: true
        descriptionEn: Query released resource details with parameters
  /api/v1/apis/{api_name}/resource-docs/import/by-archive/:
    post:
      operationId: import_resource_docs_by_archive
      description: 通过文档归档文件导入资源文档
      tags:
      - v1
      parameters:
        - name: api_name
          in: path
          required: true
          schema:
            type: string
          description: 网关名
          example: demo
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - file
              properties:
                file:
                  type: string
                  format: binary
                  description: 资源文档的归档文件对象
      responses:
        '200':
          description: 成功响应
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 0
                  message:
                    type: string
                    example: OK
                  data:
                    type: object
                    nullable: true
              example:
                code: 0
                message: OK
                data: null
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: true
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: post
          path: /backend/api/v1/apis/{api_name}/resource-docs/import/by-archive/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: false
        descriptionEn: Import resource docs by archive file
  /api/v1/apis/{api_name}/resource-docs/import/by-swagger/:
    post:
      operationId: import_resource_docs_by_swagger
      description: 通过 Swagger 格式导入文档
      tags:
      - v1
      parameters:
        - name: api_name
          in: path
          required: true
          schema:
            type: string
          description: 网关名
          example: demo
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - language
                - swagger
              properties:
                language:
                  type: string
                  description: 文档语言，可选值：zh 表示中文，en 表示英文
                  enum:
                    - zh
                    - en
                  example: zh
                swagger:
                  type: string
                  description: swagger 描述文件的内容
                  example: "xxx"
            example:
              language: zh
              swagger: "xxx"
      responses:
        '200':
          description: 成功响应
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 0
                  message:
                    type: string
                    example: OK
                  data:
                    type: object
                    nullable: true
              example:
                code: 0
                message: OK
                data: null
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: true
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: post
          path: /backend/api/v1/apis/{api_name}/resource-docs/import/by-swagger/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: false
        descriptionEn: Import resource docs by swagger
  /api/v1/apis/{api_name}/resources/sync/:
    post:
      operationId: sync_resources
      description: 同步资源
      tags:
      - v1
      parameters:
        - name: api_name
          in: path
          required: true
          schema:
            type: string
          description: 网关名
          example: demo
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - content
              properties:
                content:
                  type: string
                  description: 网关资源 swagger 描述，可为 yaml 格式文本
                  example: "xxx"
                delete:
                  type: boolean
                  description: 是否删除未指定的资源
                  example: false
                doc_language:
                  type: string
                  description: 生成接口文档的语言：en 英文，zh 中文，不传不生成
                  enum:
                    - zh
                    - en
                  example: zh
            example:
              content: "xxx"
              delete: false
      responses:
        '200':
          description: 成功响应
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 0
                  message:
                    type: string
                    example: OK
                  data:
                    type: object
                    properties:
                      added:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: integer
                        description: 新增的资源
                      updated:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: integer
                        description: 更新的资源
                      deleted:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: integer
                        description: 删除的资源
              example:
                code: 0
                message: OK
                data:
                  added: [{"id": 1}]
                  updated: [{"id": 2}]
                  deleted: [{"id": 3}]
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: true
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: post
          path: /backend/api/v1/apis/{api_name}/resources/sync/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: false
        descriptionEn: Sync resources
  /api/v1/apis/{api_name}/resource_versions/:
    get:
      operationId: list_resource_versions
      description: 查询资源版本
      tags:
      - v1
      parameters:
        - name: api_name
          in: path
          required: true
          schema:
            type: string
          description: 网关名
          example: demo
        - name: version
          in: query
          schema:
            type: string
          description: 版本号
          example: "1.0.0"
        - name: limit
          in: query
          schema:
            type: integer
            default: 10
          description: 最大返回条目数量，默认为 10
          example: 10
        - name: offset
          in: query
          schema:
            type: integer
            default: 0
          description: 相对于完整未分页数据的起始位置，默认为 0
          example: 0
      responses:
        '200':
          description: 成功返回资源版本列表
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 0
                  message:
                    type: string
                    example: OK
                  data:
                    type: object
                    properties:
                      count:
                        type: integer
                        example: 1
                      has_next:
                        type: boolean
                        example: false
                      has_previous:
                        type: boolean
                        example: false
                      results:
                        type: array
                        items:
                          type: object
                          properties:
                            version:
                              type: string
                              example: "1.0.0"
                            title:
                              type: string
                              example: test
                            comment:
                              type: string
                              example: ""
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: true
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: get
          path: /backend/api/v1/apis/{api_name}/resource_versions/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: false
        descriptionEn: List resource versions
    post:
      operationId: create_resource_version
      description: 创建资源版本
      tags:
      - v1
      parameters:
        - name: api_name
          in: path
          required: true
          schema:
            type: string
          description: 网关名
          example: demo
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - version
              properties:
                version:
                  type: string
                  description: 版本号，须符合 Semver 规范
                  example: "1.0.0"
                title:
                  type: string
                  description: 版本标题
                  example: 发布新版本
                comment:
                  type: string
                  description: 版本说明
                  example: 这是一个什么样的新版本
            example:
              version: "1.0.0"
              title: 发布新版本
              comment: 这是一个什么样的新版本
      responses:
        '200':
          description: 成功创建资源版本
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 0
                  message:
                    type: string
                    example: OK
                  data:
                    type: object
                    properties:
                      id:
                        type: integer
                        description: 资源版本ID
                        example: 1
                      version:
                        type: string
                        description: 版本号
                        example: "1.0.0"
                      title:
                        type: string
                        description: 版本标题
                        example: 发布新版本
              example:
                code: 0
                message: OK
                data:
                  id: 1
                  version: "1.0.0"
                  title: 发布新版本
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: true
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: post
          path: /backend/api/v1/apis/{api_name}/resource_versions/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: false
        descriptionEn: Create resource version
  /api/v1/apis/{api_name}/resource_versions/latest/:
    get:
      operationId: get_latest_resource_version
      description: 获取网关最新版本
      tags:
      - v1
      parameters:
        - name: api_name
          in: path
          required: true
          schema:
            type: string
          description: 网关名
          example: demo
      responses:
        '200':
          description: 成功返回最新资源版本
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 0
                  message:
                    type: string
                    example: OK
                  data:
                    type: object
                    properties:
                      version:
                        type: string
                        description: 资源版本的版本号
                        example: "1.0.1"
              example:
                code: 0
                message: OK
                data:
                  version: "1.0.1"
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: true
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: get
          path: /backend/api/v1/apis/{api_name}/resource_versions/latest/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: false
        descriptionEn: None
  /api/v1/apis/{api_name}/resource_versions/release/:
    post:
      operationId: release
      description: 发布版本
      tags:
      - v1
      parameters:
        - name: api_name
          in: path
          required: true
          schema:
            type: string
          description: 网关名
          example: demo
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - version
              properties:
                version:
                  type: string
                  description: 待发布版本的版本号
                  example: "1.0.0"
                stage_names:
                  type: array
                  items:
                    type: string
                  description: 待发布环境列表
                  example: ["prod", "test", "dev"]
                comment:
                  type: string
                  description: 发布日志
                  example: 发布
            example:
              version: "1.0.0"
              stage_names: ["prod", "test", "dev"]
              comment: 发布
      responses:
        '200':
          description: 成功发布版本
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 0
                  message:
                    type: string
                    example: OK
                  data:
                    type: object
                    properties:
                      version:
                        type: string
                        description: 发布版本号
                        example: "1.0.0"
                      stage_names:
                        type: array
                        items:
                          type: string
                        description: 发布环境名列表
                        example: ["prod", "test", "dev"]
              example:
                code: 0
                message: OK
                data:
                  version: "1.0.0"
                  stage_names: ["prod", "test", "dev"]
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: true
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: post
          path: /backend/api/v1/apis/{api_name}/resource_versions/release/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: false
        descriptionEn: None
  /api/v1/apis/{api_name}/sdk/:
    post:
      operationId: generate_sdk
      description: 生成 SDK
      tags:
      - v1
      parameters:
        - name: api_name
          in: path
          required: true
          schema:
            type: string
          description: 网关名
          example: demo
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - resource_version
              properties:
                resource_version:
                  type: string
                  description: 资源版本的版本号
                  example: "1.0.1"
                languages:
                  type: array
                  items:
                    type: string
                  description: 需要生成SDK的语言列表，可选值：python，默认为 python SDK
                  example: ["python"]
                version:
                  type: string
                  description: SDK 版本号，未设置时，将使用资源版本的版本号
                  example: "1.0.1"
            example:
              resource_version: "1.0.1"
              languages: ["python"]
              version: "1.0.1"
      responses:
        '200':
          description: 成功生成 SDK
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 0
                  message:
                    type: string
                    example: OK
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        name:
                          type: string
                          description: SDK 名称
                          example: bkapi-test
                        version:
                          type: string
                          description: SDK 版本号
                          example: "1.0.1"
                        url:
                          type: string
                          description: SDK 下载地址
                          example: "http://demo.example.com/bkapi-test-1.0.1.tar.gz"
              example:
                code: 0
                message: OK
                data:
                  - name: bkapi-test
                    version: "1.0.1"
                    url: "http://demo.example.com/bkapi-test-1.0.1.tar.gz"
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: true
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: post
          path: /backend/api/v1/apis/{api_name}/sdk/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: false
        descriptionEn: None
  /api/v1/apis/{api_name}/stages/:
    get:
      operationId: get_stages
      description: 查询环境
      tags:
      - v1
      parameters:
        - name: api_name
          in: path
          required: true
          schema:
            type: string
          description: 网关名
          example: demo
      responses:
        '200':
          description: 成功返回环境列表
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 0
                  message:
                    type: string
                    example: OK
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          description: 环境ID
                          example: 1
                        name:
                          type: string
                          description: 环境名称
                          example: prod
                        description:
                          type: string
                          description: 环境描述
                          example: 正式环境
              example:
                code: 0
                message: OK
                data:
                  - id: 1
                    name: prod
                    description: 正式环境
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: true
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: get
          path: /backend/api/v1/apis/{api_name}/stages/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: true
        descriptionEn: None
  /api/v1/apis/{api_name}/stages/sync/:
    post:
      operationId: sync_stage
      description: 同步环境
      tags:
      - v1
      parameters:
        - name: api_name
          in: path
          required: true
          schema:
            type: string
          description: 网关名
          example: demo
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - name
                - proxy_http
              properties:
                name:
                  type: string
                  description: 环境名称
                  example: prod
                description:
                  type: string
                  description: 描述
                  example: 正式环境
                vars:
                  type: object
                  additionalProperties:
                    type: string
                  description: 环境变量，包含变量名、值，变量名、值均为字符串类型
                  example:
                    foo: bar
                proxy_http:
                  type: object
                  description: 代理配置
                  required:
                    - timeout
                    - upstreams
                  properties:
                    timeout:
                      type: integer
                      description: 超时时间，单位秒，取值范围 1 ~ 300
                      example: 60
                    upstreams:
                      type: object
                      description: 后端服务地址
                      required:
                        - loadbalance
                        - hosts
                      properties:
                        loadbalance:
                          type: string
                          description: 负载均衡类型，可选值：roundrobin
                          example: roundrobin
                        hosts:
                          type: array
                          items:
                            type: object
                            properties:
                              host:
                                type: string
                                description: 后端服务域名、IP + 端口
                                example: "http://api.example.com"
                              weight:
                                type: integer
                                description: 权重，可选值 1 ~ 10000
                                example: 100
                    transform_headers:
                      type: object
                      description: Header 转换配置
                      properties:
                        set:
                          type: object
                          additionalProperties:
                            type: string
                          description: 设置 Header
                        delete:
                          type: array
                          items:
                            type: string
                          description: 删除 Header
            example:
              name: prod
              description: 正式环境
              vars:
                foo: bar
              proxy_http:
                timeout: 60
                upstreams:
                  loadbalance: roundrobin
                  hosts:
                    - host: "http://api.example.com"
                      weight: 100
                transform_headers:
                  set:
                    X-Token: foo
                  delete: ["X-Test"]
      responses:
        '200':
          description: 成功同步环境
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 0
                  message:
                    type: string
                    example: OK
                  data:
                    type: object
                    properties:
                      id:
                        type: integer
                        description: 环境ID
                        example: 1
                      name:
                        type: string
                        description: 环境名称
                        example: demo
              example:
                code: 0
                message: OK
                data:
                  id: 1
                  name: demo
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: true
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: post
          path: /backend/api/v1/apis/{api_name}/stages/sync/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: false
        descriptionEn: None
  /api/v1/apis/{api_name}/stages/with-resource-version/:
    get:
      operationId: get_stages_with_resource_version
      description: 查询网关环境资源版本
      tags:
      - v1
      parameters:
        - name: api_name
          in: path
          required: true
          schema:
            type: string
          description: 网关名
          example: demo
      responses:
        '200':
          description: 成功返回环境列表及资源版本
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 0
                  message:
                    type: string
                    example: OK
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        name:
                          type: string
                          description: 环境名称
                          example: prod
                        resource_version:
                          type: object
                          nullable: true
                          description: 资源版本
                          properties:
                            version:
                              type: string
                              description: 版本
                              example: "1.0.1"
                        released:
                          type: boolean
                          description: 是否已发布
                          example: true
              example:
                code: 0
                message: OK
                data:
                  - name: prod
                    resource_version:
                      version: "1.0.1"
                    released: true
                  - name: test
                    resource_version: null
                    released: false
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: true
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: get
          path: /backend/api/v1/apis/{api_name}/stages/with-resource-version/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: false
        descriptionEn: get stages with resource version
  /api/v1/apis/{api_name}/status/:
    post:
      operationId: update_gateway_status
      description: 修改网关状态
      tags:
      - v1
      parameters:
        - name: api_name
          in: path
          required: true
          schema:
            type: string
          description: 网关名
          example: demo
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - status
              properties:
                status:
                  type: integer
                  description: 网关状态，0：表示停用，1：表示启用
                  enum:
                    - 0
                    - 1
                  example: 1
            example:
              status: 1
      responses:
        '200':
          description: 成功更新网关状态
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 0
                  message:
                    type: string
                    example: OK
                  data:
                    type: object
                    nullable: true
              example:
                code: 0
                message: OK
                data: null
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: true
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: post
          path: /backend/api/v1/apis/{api_name}/status/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: false
        descriptionEn: None
  /api/v1/apis/{api_name}/sync/:
    post:
      operationId: sync_api
      description: 同步网关
      tags:
      - v1
      parameters:
        - name: api_name
          in: path
          required: true
          schema:
            type: string
          description: 网关名
          example: demo
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                description:
                  type: string
                  description: 网关描述
                  example: just for test
                maintainers:
                  type: array
                  items:
                    type: string
                  description: 网关管理员
                  example: ["admin"]
                is_public:
                  type: boolean
                  description: 网关是否公开，默认公开
                  example: true
            example:
              description: just for test
              maintainers: ["admin"]
              is_public: true
      responses:
        '200':
          description: 成功同步网关
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 0
                  message:
                    type: string
                    example: OK
                  data:
                    type: object
                    properties:
                      id:
                        type: integer
                        description: 网关ID
                        example: 1
                      name:
                        type: string
                        description: 网关名称
                        example: demo
              example:
                code: 0
                message: OK
                data:
                  id: 1
                  name: demo
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: true
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: post
          path: /backend/api/v1/apis/{api_name}/sync/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: false
        descriptionEn: None
  /api/v2/open/gateways/:
    get:
      operationId: v2_open_list_gateways
      description: 获取网关列表
      tags:
      - v2_open
      parameters:
        - name: name
          in: query
          schema:
            type: string
          description: 网关名称，用于过滤网关
          example: bk-apigateway
        - name: fuzzy
          in: query
          schema:
            type: boolean
          description: 是否模糊匹配，true：模糊匹配（name 包含），false：精确匹配
          example: true
        - name: keyword
          in: query
          schema:
            type: string
          description: 搜索关键字，模糊匹配 name 或 description
          example: apigateway
      responses:
        '200':
          description: 成功返回网关列表
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          description: 网关 ID
                          example: 1
                        name:
                          type: string
                          description: 网关名称
                          example: bk-apigateway
                        description:
                          type: string
                          description: 网关描述
                          example: 蓝鲸 API 网关
                        maintainers:
                          type: array
                          items:
                            type: string
                          description: 网关管理员
                          example: ["admin"]
                        doc_maintainers:
                          type: array
                          items:
                            type: string
                          description: 文档管理员
                          example: ["admin"]
              example:
                data:
                  - id: 1
                    name: bk-apigateway
                    description: 蓝鲸 API 网关
                    maintainers: ["admin"]
                    doc_maintainers: ["admin"]
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: true
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: get
          path: /backend/api/v2/open/gateways/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: true
        descriptionEn: None
  /api/v2/open/gateways/batch-query/:
    post:
      operationId: v2_open_batch_query_gateways
      description: 批量根据网关 ID 或名称查询网关展示名称和描述
      tags:
        - v2_open
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                ids:
                  type: array
                  items:
                    type: integer
                  description: 网关 ID 列表（ids 和 names 至少提供一个）
                names:
                  type: array
                  items:
                    type: string
                  description: 网关名称列表（ids 和 names 至少提供一个）
                  example: ["bk-apigateway", "bk-esb"]
                fields:
                  type: string
                  description: 指定返回的字段列表，逗号分隔；不传默认返回 id 和 name
      responses:
        '200':
          description: 成功返回网关信息
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          description: 网关 ID
                        name:
                          type: string
                          description: 网关名称
                        description:
                          type: string
                          description: 网关描述
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: true
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: post
          path: /backend/api/v2/open/gateways/batch-query/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: true
        descriptionEn: Batch query gateway display name and description by gateway names
  /api/v2/open/gateways/{gateway_name}/:
    get:
      operationId: v2_open_get_gateway
      description: 获取网关
      tags:
      - v2_open
      parameters:
        - name: gateway_name
          in: path
          required: true
          schema:
            type: string
          description: 网关名称
          example: bk-apigateway
      responses:
        '200':
          description: 成功返回网关信息
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      id:
                        type: integer
                        description: 网关 ID
                        example: 1
                      name:
                        type: string
                        description: 网关名称
                        example: bk-apigateway
                      description:
                        type: string
                        description: 网关描述
                        example: ""
                      maintainers:
                        type: array
                        items:
                          type: string
                        description: 网关管理员
                        example: ["admin"]
              example:
                data:
                  id: 1
                  name: bk-apigateway
                  description: ""
                  maintainers: ["admin"]
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: true
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: get
          path: /backend/api/v2/open/gateways/{gateway_name}/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: true
        descriptionEn: None
  /api/v2/open/gateways/{gateway_name}/resources/:
    get:
      operationId: v2_open_list_gateway_resources
      description: 获取网关资源列表
      tags:
        - v2_open
      responses:
        default:
          description: ''
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    properties:
                      resource_info:
                        type: object
                        properties:
                          id:
                            type: number
                            description: 资源id
                          name:
                            type: string
                            description: 资源name
                          description:
                            type: string
                            description: 资源描述
                          method:
                            type: string
                            description: 请求方法（GET、POST 等）
                          path:
                            type: string
                            description: '资源路径  '
                          match_subpath:
                            type: boolean
                            description: '是否匹配子路径 '
                          enable_websocket:
                            type: boolean
                            description: '是否启用 WebSocket '
                          is_public:
                            type: boolean
                            description: 是否公开
                          labels:
                            type: array
                            description: 标签列表
                            properties:
                              label:
                                type: object
                                properties:
                                  id:
                                    type: number
                                    description: 标签id
                                  name:
                                    type: string
                                    description: 标签name
                          auth_config:
                            type: object
                            properties:
                              user_verified_required:
                                type: boolean
                                description: '是否需要用户认证; True: 那么调用接口需要提供用户身份：例如：bk_ticket'
                              app_verified_required:
                                type: boolean
                                description: '是否需要应用认证; True: 那么调用接口需要提供应用身份：bk_app_code+bk_app_secret'
                              resource_perm_required:
                                type: boolean
                                description: '是否需要资源权限; True: 则需要申请该资源权限才可以调用'
      parameters:
        - in: path
          name: gateway_name
          description: 网关name
          required: true
          schema:
            type: string
        - in: query
          name: keyword
          description: 搜索关键字，模糊匹配资源 name、description 或标签名称
          schema:
            type: string
        - in: query
          name: fields
          description: 指定返回的字段列表，逗号分隔，如 fields=id,name,method；不传默认返回 id 和 name
          schema:
            type: string
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: get
          path: /backend/api/v2/open/gateways/{gateway_name}/resources/
          matchSubpath: false
          timeout: 0
        pluginConfigs: [ ]
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: true
        descriptionEn: None
  /api/v2/open/gateways/{gateway_name}/resources/{resource_name}/:
    get:
      operationId: v2_open_retrieve_gateway_api_details
      description: 获取网关资源详情
      tags:
        - v2_open
      responses:
        default:
          description: 资源详情
          content:
            application/json:
              schema:
                type: object
                description: 资源详情
                properties:
                  id:
                    type: number
                    description: 资源id
                  name:
                    type: string
                    description: 资源名称
                  description:
                    type: string
                    description: 资源描述（中文）
                  description_en:
                    type: string
                    description: '资源描述（英文） '
                  method:
                    type: string
                    description: '请求方法（GET、POST 等） '
                  path:
                    type: string
                    description: ' 资源路径  '
                  'match_subpath ':
                    type: string
                    description: 是否匹配子路径
                  enable_websocket:
                    type: string
                    description: '是否启用 WebSocket '
                  is_public:
                    type: boolean
                    description: '是否公开 '
                  schema:
                    type: object
                    description: OpenAPI Schema 定义
                  doc:
                    type: object
                    properties:
                      type:
                        type: string
                        description: 文档类型（通常为 markdown）
                      content:
                        type: string
                        description: 文档内容（Markdown 格式）
                      updated_time:
                        type: string
                        description: 文档更新时间（ISO 8601 格式）
                  auth_config:
                    type: object
                    description: 资源认证相关信息
                    properties:
                      user_verified_required:
                        type: boolean
                        description: '是否需要用户认证; True: 那么调用接口需要提供用户身份：例如：bk_ticket)'
                      app_verified_required:
                        type: boolean
                        description: '是否需要应用认证; True: 那么调用接口需要提供应用身份：bk_app_code+bk_app_secret'
                      resource_perm_required:
                        type: boolean
                        description: '是否需要资源权限; True: 则需要申请该资源权限才可以调用      '
      parameters:
        - in: path
          name: gateway_name
          description: 网关名
          required: true
          schema:
            type: string
        - in: path
          name: resource_name
          description: 资源名称
          required: true
          schema:
            type: string
        - in: query
          name: stage_name
          description: 环境名称
          required: true
          schema:
            type: string
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: get
          path: /backend/api/v2/open/gateways/{gateway_name}/resources/{resource_name}/
          matchSubpath: false
          timeout: 0
        pluginConfigs: [ ]
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: true
        descriptionEn: None
  /api/v2/open/gateways/{gateway_name}/resources/{resource_name}/info/:
    get:
      operationId: v2_open_retrieve_gateway_resource_info
      description: 根据资源名称获取网关下单个资源的基本信息
      tags:
        - v2_open
      parameters:
        - in: path
          name: gateway_name
          description: 网关名称
          required: true
          schema:
            type: string
        - in: path
          name: resource_name
          description: 资源名称
          required: true
          schema:
            type: string
      responses:
        '200':
          description: 成功返回资源基本信息
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      id:
                        type: integer
                        description: 资源 ID
                      name:
                        type: string
                        description: 资源名称
                      description:
                        type: string
                        description: 资源描述
                      method:
                        type: string
                        description: 请求方法
                      path:
                        type: string
                        description: 资源路径
                      match_subpath:
                        type: boolean
                        description: 是否匹配子路径
                      is_public:
                        type: boolean
                        description: 是否公开
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: true
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: get
          path: /backend/api/v2/open/gateways/{gateway_name}/resources/{resource_name}/info/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: true
        descriptionEn: Get basic info of a single resource under a gateway by resource name
  /api/v2/open/gateway/{gateway_name}/public_key/:
    get:
      operationId: v2_open_get_gateway_public_key
      description: 获取网关公钥(废弃)
      tags:
      - v2_open
      parameters:
        - name: gateway_name
          in: path
          required: true
          schema:
            type: string
          description: 网关名称
          example: bk-apigateway
      responses:
        '200':
          description: 成功返回网关公钥
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 0
                  result:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: ""
                  data:
                    type: object
                    properties:
                      issuer:
                        type: string
                        description: 颁发者
                        example: APIGW
                      public_key:
                        type: string
                        description: 公钥
                        example: "-----BEGIN PUBLIC KEY-----\nMIIBIjAN..."
      x-bk-apigateway-resource:
        isPublic: false
        allowApplyPermission: true
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: core-api
          method: get
          path: /api/v1/open/gateways/{gateway_name}/public_key/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: false
        descriptionEn: None
  /api/v2/open/gateways/{gateway_name}/public_key/:
    get:
      operationId: v2_open_get_gateway_public_key_new
      description: 获取网关公钥
      tags:
      - v2_open
      parameters:
        - name: gateway_name
          in: path
          required: true
          schema:
            type: string
          description: 网关名称
          example: bk-apigateway
      responses:
        '200':
          description: 成功返回网关公钥
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 0
                  result:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: ""
                  data:
                    type: object
                    properties:
                      issuer:
                        type: string
                        description: 颁发者
                        example: APIGW
                      public_key:
                        type: string
                        description: 公钥
                        example: "-----BEGIN PUBLIC KEY-----\nMIIBIjAN..."
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: true
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: core-api
          method: get
          path: /api/v1/open/gateways/{gateway_name}/public_key/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: false
        descriptionEn: None
  /api/v2/open/gateways/{gateway_name}/permissions/apply/:
    post:
      operationId: v2_open_apply_gateway_permission
      description: 申请网关权限
      tags:
        - v2_open
      parameters:
        - name: gateway_name
          in: path
          required: true
          schema:
            type: string
          description: 网关名
          example: bk-apigateway
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - target_app_code
                - grant_dimension
              properties:
                target_app_code:
                  type: string
                  description: 申请权限的应用，应于当前请求的应用一致
                  example: my-app
                expire_days:
                  type: integer
                  description: 过期时间，0 或未提供表示永久，180 表示 6 个月，360 表示 12 个月
                  example: 360
                grant_dimension:
                  type: string
                  description: 授权维度，api 表示按网关申请权限
                  enum:
                    - api
                  example: api
                reason:
                  type: string
                  description: 申请原因
                  example: test
            example:
              target_app_code: my-app
              expire_days: 360
              grant_dimension: api
              reason: test
      responses:
        '200':
          description: 成功返回申请记录
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      record_id:
                        type: integer
                        description: 权限申请单的单据ID
                        example: 12345
              example:
                data:
                  record_id: 12345
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: true
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: post
          path: /backend/api/v2/open/gateways/{gateway_name}/permissions/apply/
          matchSubpath: false
          timeout: 0
        pluginConfigs: [ ]
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: false
        descriptionEn: None
  /api/v2/open/mcp-servers/:
    get:
      operationId: v2_open_list_mcp_server
      description: 获取公开的 mcp_server 列表
      tags:
        - v2_open
      parameters:
        - name: keyword
          in: query
          schema:
            type: string
          description: 筛选条件，支持模糊匹配 MCPServer 名称或描述
          example: test
        - name: category
          in: query
          schema:
            type: string
          description: 分类名称，精确过滤 MCPServer 所属分类
          example: official
        - name: limit
          in: query
          schema:
            type: integer
            default: 10
          description: 最大返回条目数量，默认为 10
          example: 10
        - name: offset
          in: query
          schema:
            type: integer
            default: 0
          description: 相对于完整未分页数据的起始位置，默认为 0
          example: 0
      responses:
        '200':
          description: 成功返回 mcp_server 列表
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      count:
                        type: integer
                        description: 总数
                        example: 1
                      results:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: integer
                              description: mcp_server ID
                              example: 2
                            name:
                              type: string
                              description: mcp_server 名称
                              example: test
                            title:
                              type: string
                              description: mcp_server 中文名/显示名称
                              example: 测试服务
                            description:
                              type: string
                              nullable: true
                              description: mcp_server 描述
                            is_public:
                              type: boolean
                              description: mcp_server 是否公开
                              example: true
                            status:
                              type: integer
                              description: mcp_server 状态（0：已停用，1：启用中）
                              example: 1
                            protocol_type:
                              type: string
                              description: MCP 协议类型（sse：SSE 协议，streamable_http：Streamable HTTP 协议）
                              example: sse
                            tools_count:
                              type: integer
                              description: mcp_server 工具数量
                              example: 0
                            url:
                              type: string
                              description: mcp_server 访问地址
                              example: ""
                            detail_url:
                              type: string
                              description: mcp_server 网关站点详情地址
                              example: ""
                            gateway:
                              type: object
                              properties:
                                id:
                                  type: integer
                                  description: 网关 ID
                                name:
                                  type: string
                                  description: 网关名称
                                maintainers:
                                  type: array
                                  items:
                                    type: string
                                  description: 网关管理员
                                is_official:
                                  type: boolean
                                  description: 是否为官方网关
                            stage:
                              type: object
                              properties:
                                id:
                                  type: integer
                                  description: 环境 ID
                                name:
                                  type: string
                                  description: 环境名称
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: true
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: get
          path: /backend/api/v2/open/mcp-servers/
          matchSubpath: false
          timeout: 0
        pluginConfigs: [ ]
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: true
        descriptionEn: None
  /api/v2/open/mcp-servers/categories/:
    get:
      operationId: v2_open_list_mcp_server_categories
      description: 获取 MCPServer 分类列表
      tags:
        - v2_open
      responses:
        '200':
          description: 成功返回分类列表
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        name:
                          type: string
                          description: 分类名称（英文标识）
                        display_name:
                          type: string
                          description: 分类显示名称
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: true
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: get
          path: /backend/api/v2/open/mcp-servers/categories/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: true
        descriptionEn: List active MCPServer categories
  /api/v2/open/mcp-servers/batch-query/:
    post:
      operationId: v2_open_batch_query_mcp_servers
      description: 批量根据 MCPServer ID 或名称查询 MCPServer 展示名称、描述和分类
      tags:
        - v2_open
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                ids:
                  type: array
                  items:
                    type: integer
                  description: MCPServer ID 列表（ids 和 names 至少提供一个）
                names:
                  type: array
                  items:
                    type: string
                  description: MCPServer 名称列表（ids 和 names 至少提供一个）
                  example: ["test-mcp-server", "another-mcp-server"]
                fields:
                  type: string
                  description: 指定返回的字段列表，逗号分隔；不传默认返回 id 和 name
      responses:
        '200':
          description: 成功返回 MCPServer 信息
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          description: MCPServer ID
                        name:
                          type: string
                          description: MCPServer 名称
                        title:
                          type: string
                          description: MCPServer 中文名/显示名称
                        description:
                          type: string
                          description: MCPServer 描述
                        categories:
                          type: array
                          items:
                            type: object
                            properties:
                              name:
                                type: string
                                description: 分类名称
                              display_name:
                                type: string
                                description: 分类显示名称
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: true
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: post
          path: /backend/api/v2/open/mcp-servers/batch-query/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: true
        descriptionEn: Batch query MCP server display name, description and categories by names
  /api/v2/open/mcp-servers/{mcp_server_id}/:
    get:
      operationId: v2_open_retrieve_mcp_server
      description: 获取 mcp_server 详情
      tags:
        - v2_open
      responses:
        default:
          description: ''
          content:
            application/json:
              schema: { }
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: true
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: get
          path: /backend/api/v2/open/mcp-servers/{mcp_server_id}/
          matchSubpath: false
          timeout: 0
        pluginConfigs: [ ]
        authConfig:
          userVerifiedRequired: true
          appVerifiedRequired: true
          resourcePermissionRequired: true
        descriptionEn: None
  /api/v2/open/mcp-servers/{mcp_server_id}/permissions/:
    get:
      operationId: v2_open_list_mcp_server_permissions
      description: 获取 mcp_server 的权限列表
      tags:
        - v2_open
      parameters:
        - name: mcp_server_id
          in: path
          required: true
          schema:
            type: integer
          description: mcp_server ID
          example: 1
        - name: limit
          in: query
          schema:
            type: integer
            default: 10
          description: 最大返回条目数量，默认为 10
          example: 10
        - name: offset
          in: query
          schema:
            type: integer
            default: 0
          description: 相对于完整未分页数据的起始位置，默认为 0
          example: 0
      responses:
        '200':
          description: 成功返回权限列表
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      count:
                        type: integer
                        example: 1
                      results:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: integer
                              description: 权限记录 ID
                              example: 1
                            bk_app_code:
                              type: string
                              description: 蓝鲸应用编码
                              example: bk-001
                            expires:
                              type: string
                              description: 过期时间
                              example: "2100-01-01 08:00:00 +0800"
                            grant_type:
                              type: string
                              description: 授权类型（grant：授权，apply：申请）
                              example: apply
                            mcp_server:
                              type: object
                              properties:
                                id:
                                  type: integer
                                  description: mcp_server ID
                                name:
                                  type: string
                                  description: mcp_server 名称
                                title:
                                  type: string
                                  description: mcp_server 中文名/显示名称
                                description:
                                  type: string
                                  nullable: true
                                  description: mcp_server 描述
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: true
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: get
          path: /backend/api/v2/open/mcp-servers/{mcp_server_id}/permissions/
          matchSubpath: false
          timeout: 0
        pluginConfigs: [ ]
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: true
        descriptionEn: None
  /api/v2/open/mcp-servers/permissions/:
    get:
      operationId: v2_open_list_mcp_server_app_permissions
      description: 获取 app_code 的权限列表
      tags:
        - v2_open
      parameters:
        - name: bk_app_code
          in: query
          required: true
          schema:
            type: string
          description: 蓝鲸应用编码
          example: bk-001
        - name: limit
          in: query
          schema:
            type: integer
            default: 10
          description: 最大返回条目数量，默认为 10
          example: 10
        - name: offset
          in: query
          schema:
            type: integer
            default: 0
          description: 相对于完整未分页数据的起始位置，默认为 0
          example: 0
      responses:
        '200':
          description: 成功返回权限列表
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      count:
                        type: integer
                        example: 1
                      results:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: integer
                              description: 权限记录 ID
                              example: 1
                            bk_app_code:
                              type: string
                              description: 蓝鲸应用编码
                              example: bk-001
                            expires:
                              type: string
                              description: 过期时间
                              example: "2100-01-01 08:00:00 +0800"
                            grant_type:
                              type: string
                              description: 授权类型（grant：授权，apply：申请）
                              example: apply
                            mcp_server:
                              type: object
                              properties:
                                id:
                                  type: integer
                                  description: mcp_server ID
                                name:
                                  type: string
                                  description: mcp_server 名称
                                title:
                                  type: string
                                  description: mcp_server 中文名/显示名称
                                description:
                                  type: string
                                  nullable: true
                                  description: mcp_server 描述
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: true
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: get
          path: /backend/api/v2/open/mcp-servers/permissions/
          matchSubpath: false
          timeout: 0
        pluginConfigs: [ ]
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: true
        descriptionEn: None
  /api/v2/open/mcp-servers/permissions/apply/:
    post:
      operationId: v2_open_mcp_server_app_permissions_apply
      description: 指定应用发起 mcp_server 权限申请
      tags:
        - v2_open
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - bk_app_code
                - mcp_server_ids
                - applied_by
                - reason
              properties:
                bk_app_code:
                  type: string
                  description: 蓝鲸应用编码
                  example: bk-001
                mcp_server_ids:
                  type: array
                  items:
                    type: integer
                  description: mcp_server ID 列表
                  example: [1, 2, 3]
                applied_by:
                  type: string
                  description: 申请人
                  example: admin
                reason:
                  type: string
                  description: 申请原因
                  example: 业务需要
            example:
              bk_app_code: bk-001
              mcp_server_ids: [1, 2, 3]
              applied_by: admin
              reason: 业务需要
      responses:
        '200':
          description: 成功返回申请记录
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        record_id:
                          type: integer
                          description: 申请记录 ID
                          example: 10
                        bk_app_code:
                          type: string
                          description: 蓝鲸应用编码
                          example: bk-001
                        mcp_server_id:
                          type: integer
                          description: mcp_server ID
                          example: 1
                        approval_url:
                          type: string
                          description: 权限审批 URL
                          example: "http://dashboard.example.com/123/mcp/permission?serverId=1"
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: true
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: post
          path: /backend/api/v2/open/mcp-servers/permissions/apply/
          matchSubpath: false
          timeout: 0
        pluginConfigs: [ ]
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: true
        descriptionEn: None
  /api/v2/open/mcp-servers/permissions/apply-records/:
    get:
      operationId: v2_open_list_mcp_server_app_permissions_apply_records
      description: 获取指定应用的 mcp_server 权限申请记录列表
      tags:
        - v2_open
      parameters:
        - name: bk_app_code
          in: query
          required: true
          schema:
            type: string
          description: 蓝鲸应用编码
          example: bk-001
        - name: mcp_server_id
          in: query
          schema:
            type: integer
          description: mcp_server ID
          example: 1
        - name: record_id
          in: query
          schema:
            type: integer
          description: 申请记录 ID
          example: 1
        - name: limit
          in: query
          schema:
            type: integer
            default: 10
          description: 最大返回条目数量，默认为 10
          example: 10
        - name: offset
          in: query
          schema:
            type: integer
            default: 0
          description: 相对于完整未分页数据的起始位置，默认为 0
          example: 0
      responses:
        '200':
          description: 成功返回申请记录列表
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          description: 申请记录 ID
                          example: 1
                        bk_app_code:
                          type: string
                          description: 蓝鲸应用编码
                          example: bk-001
                        applied_by:
                          type: string
                          description: 申请人
                          example: admin
                        applied_time:
                          type: string
                          description: 申请时间
                          example: "2025-06-09 11:13:26 +0800"
                        handled_by:
                          type: string
                          description: 审批人
                          example: admin
                        handled_time:
                          type: string
                          description: 审批时间
                          example: "2025-07-02 14:29:04 +0800"
                        status:
                          type: string
                          description: 审批状态
                          example: approved
                        status_display:
                          type: string
                          description: 审批状态描述
                          example: 通过
                        comment:
                          type: string
                          description: 审批内容
                          example: ""
                        reason:
                          type: string
                          description: 申请理由
                          example: ""
                        expire_days:
                          type: integer
                          description: 过期时间
                          example: 0
                        approval_url:
                          type: string
                          description: 权限审批 URL
                          example: "http://dashboard.example.com/123/mcp/permission?serverId=1"
                        mcp_server:
                          type: object
                          properties:
                            id:
                              type: integer
                              description: mcp_server ID
                            name:
                              type: string
                              description: mcp_server 名称
                            title:
                              type: string
                              description: mcp_server 中文名/显示名称
                            description:
                              type: string
                              nullable: true
                              description: mcp_server 描述
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: true
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: get
          path: /backend/api/v2/open/mcp-servers/permissions/apply-records/
          matchSubpath: false
          timeout: 0
        pluginConfigs: [ ]
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: true
        descriptionEn: None
  /api/v2/open/user/mcp-servers/:
    get:
      operationId: v2_open_list_user_mcp_server
      description: 获取 mcp_server 列表
      tags:
        - v2_open
      parameters:
        - name: is_public
          in: query
          schema:
            type: boolean
          description: 是否公开，true：公开，false：不公开，不传或传空则查询全部
          example: true
        - name: keyword
          in: query
          schema:
            type: string
          description: 筛选条件，支持模糊匹配 MCPServer 名称或描述
          example: test
        - name: limit
          in: query
          schema:
            type: integer
            default: 10
          description: 最大返回条目数量，默认为 10
          example: 10
        - name: offset
          in: query
          schema:
            type: integer
            default: 0
          description: 相对于完整未分页数据的起始位置，默认为 0
          example: 0
      responses:
        '200':
          description: 成功返回 mcp_server 列表
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      count:
                        type: integer
                        example: 1
                      results:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: integer
                              description: mcp_server ID
                            name:
                              type: string
                              description: mcp_server 名称
                            title:
                              type: string
                              description: mcp_server 中文名/显示名称
                            description:
                              type: string
                              nullable: true
                              description: mcp_server 描述
                            is_public:
                              type: boolean
                              description: mcp_server 是否公开
                            status:
                              type: integer
                              description: mcp_server 状态（0：已停用，1：启用中）
                            protocol_type:
                              type: string
                              description: MCP 协议类型
                            tools_count:
                              type: integer
                              description: mcp_server 工具数量
                            url:
                              type: string
                              description: mcp_server 访问地址
                            application_url:
                              type: string
                              description: 应用态 URL
                            least_privilege:
                              type: string
                              description: 最低权限要求（application / application_and_user）
                            gateway:
                              type: object
                              properties:
                                id:
                                  type: integer
                                name:
                                  type: string
                                maintainers:
                                  type: array
                                  items:
                                    type: string
                                is_official:
                                  type: boolean
                            stage:
                              type: object
                              properties:
                                id:
                                  type: integer
                                name:
                                  type: string
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: true
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: get
          path: /backend/api/v2/open/user/mcp-servers/
          matchSubpath: false
          timeout: 0
        pluginConfigs: [ ]
        authConfig:
          userVerifiedRequired: true
          appVerifiedRequired: true
          resourcePermissionRequired: true
        descriptionEn: None
  /api/v2/open/tools/time/get_datetime/:
    get:
      operationId: v2_open_tools_time_get_datetime
      description: 获取当前时间
      tags:
        - v2_open
      responses:
        default:
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      datetime:
                        type: string
                        description: 'format is %Y-%m-%d %H:%M:%S'
          description: ''
      parameters:
      - in: query
        name: tz_name
        schema:
          type: string
          default: Asia/Shanghai
        description: timezone
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: get
          path: /backend/api/v2/open/tools/time/get_datetime/
          matchSubpath: false
          timeout: 0
        pluginConfigs: [ ]
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: false
        descriptionEn: None
  /api/v2/open/tools/time/get_current_unix_timestamp/:
    get:
      operationId: v2_open_tools_time_get_current_unix_timestamp
      description: 获取当前时间戳
      tags:
        - v2_open
      responses:
        default:
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      unix_timestamp:
                        type: number
                        description: 'e.g. 1767665249'
          description: ''
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: get
          path: /backend/api/v2/open/tools/time/get_current_unix_timestamp/
          matchSubpath: false
          timeout: 0
        pluginConfigs: [ ]
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: false
        descriptionEn: None
  /api/v2/open/tools/time/parse_datetime_str_to_timestamp/:
    post:
      operationId: v2_open_tools_time_parse_datetime_str_to_timestamp
      description: 将时间字符串转换为时间戳
      tags:
        - v2_open
      responses:
        default:
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      timestamp:
                        type: number
                        description: e.g. 1767665249
          description: ''
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
              - datetime
              properties:
                datetime:
                  type: string
                  description: '2026-01-05 12:00:00'
                datetime_format:
                  type: string
                  default: '%Y-%m-%d %H:%M:%S'
                  description: python's datetime format
        required: false
        description: ''
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: post
          path: /backend/api/v2/open/tools/time/parse_datetime_str_to_timestamp/
          matchSubpath: false
          timeout: 0
        pluginConfigs: [ ]
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: false
        descriptionEn: None
  /api/v2/open/tools/log/query_by_request_id/:
    get:
      operationId: v2_open_tools_log_query_by_request_id
      description: 根据 request_id 查询日志
      tags:
        - v2_open
      responses:
        default:
          description: ''
          content:
            application/json:
              schema: { }
      parameters:
      - in: query
        name: request_id
        schema:
          type: string
        required: true
        description: request_id, 36 位 uuid
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: get
          path: /backend/api/v2/open/tools/log/query_by_request_id/
          matchSubpath: false
          timeout: 0
        pluginConfigs: [ ]
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: false
        descriptionEn: None
  /api/v2/open/.well-known/oauth-protected-resource:
    get:
      operationId: v2_open_oauth_protected_resource
      description: 获取 OAuth 保护资源元数据
      tags:
        - v2_open
      responses:
        default:
          description: ''
          content:
            application/json:
              schema: {}
      parameters:
        - in: query
          name: resource
          schema:
            type: string
          required: true
          description: The resource URL
      x-bk-apigateway-resource:
        isPublic: false
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: get
          path: /backend/api/v2/open/.well-known/oauth-protected-resource
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: false
          resourcePermissionRequired: false
        descriptionEn: Get OAuth Protected Resource Metadata
  /api/v2/sync/gateways/{gateway_name}/public_key/:
    get:
      operationId: v2_sync_get_gateway_public_key_new
      description: 获取网关公钥
      tags:
      - v2_sync
      parameters:
        - name: gateway_name
          in: path
          required: true
          schema:
            type: string
          description: 网关名称
          example: bk-apigateway
      responses:
        '200':
          description: 成功返回网关公钥
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 0
                  result:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: ""
                  data:
                    type: object
                    properties:
                      issuer:
                        type: string
                        description: 颁发者
                        example: APIGW
                      public_key:
                        type: string
                        description: 公钥
                        example: "-----BEGIN PUBLIC KEY-----\nMIIBIjAN..."
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: core-api
          method: get
          path: /api/v1/open/gateways/{gateway_name}/public_key/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: false
        descriptionEn: None
  /api/v2/sync/gateways/{gateway_name}/related-apps/:
    post:
      operationId: v2_sync_add_related_apps
      description: 添加网关的关联应用
      tags:
      - v2_sync
      parameters:
        - name: gateway_name
          in: path
          required: true
          schema:
            type: string
          description: 网关名称
          example: bk-apigateway
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - related_app_codes
              properties:
                related_app_codes:
                  type: array
                  items:
                    type: string
                  description: 应用编码列表
                  example: ["bk_apigateway"]
            example:
              related_app_codes: ["bk_apigateway"]
      responses:
        '201':
          description: 成功添加关联应用
          content:
            application/json:
              schema:
                type: object
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: post
          path: /backend/api/v2/sync/gateways/{gateway_name}/related-apps/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: false
        descriptionEn: None
  /api/v2/sync/gateways/{gateway_name}/stages/:
    post:
      operationId: v2_sync_stages
      description: 同步网关stage
      tags:
        - v2_sync
      parameters:
        - name: gateway_name
          in: path
          required: true
          schema:
            type: string
          description: 网关名
          example: demo
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - name
                - backends
              properties:
                name:
                  type: string
                  description: 环境名称
                  example: stag
                description:
                  type: string
                  description: 中文描述
                  example: 预发布环境
                description_en:
                  type: string
                  description: 英文描述
                  example: Staging Env
                vars:
                  type: object
                  additionalProperties:
                    type: string
                  description: 环境变量
                  example:
                    api_sub_path: "/test"
                backends:
                  type: array
                  items:
                    type: object
                    required:
                      - name
                      - config
                    properties:
                      name:
                        type: string
                        description: 后端服务名称
                        example: default
                      config:
                        type: object
                        required:
                          - timeout
                          - loadbalance
                          - hosts
                        properties:
                          timeout:
                            type: integer
                            description: 超时时间（单位：秒）
                            example: 60
                          loadbalance:
                            type: string
                            description: 负载均衡类型
                            example: roundrobin
                          hosts:
                            type: array
                            items:
                              type: object
                              properties:
                                host:
                                  type: string
                                  description: 后端服务域名、IP + 端口
                                weight:
                                  type: integer
                                  description: 权重
                plugin_configs:
                  type: array
                  items:
                    type: object
                    properties:
                      type:
                        type: string
                        description: 插件类型
                        example: bk-rate-limit
                      yaml:
                        type: string
                        description: YAML 格式的插件配置
      responses:
        '200':
          description: 成功同步环境
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      id:
                        type: integer
                        description: 环境ID
                        example: 1
                      name:
                        type: string
                        description: 环境名称
                        example: demo
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: post
          path: /backend/api/v2/sync/gateways/{gateway_name}/stages/
          matchSubpath: false
          timeout: 0
        pluginConfigs: [ ]
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: false
        descriptionEn: None

  /api/v2/sync/gateways/{gateway_name}/stages/{stage_name}/mcp-servers/:
    post:
      operationId: v2_sync_stage_mcp_servers
      description: 同步网关 stage mcp_servers
      tags:
        - v2_sync
      parameters:
        - name: gateway_name
          in: path
          required: true
          schema:
            type: string
          description: 网关名
          example: demo
        - name: stage_name
          in: path
          required: true
          schema:
            type: string
          description: 环境名
          example: prod
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - mcp_servers
              properties:
                mcp_servers:
                  type: array
                  items:
                    type: object
                    required:
                      - name
                      - description
                      - resource_names
                    properties:
                      name:
                        type: string
                        description: MCP Server 名字
                        example: mcp1
                      title:
                        type: string
                        description: MCP Server 中文名/显示名称
                        example: 服务1
                      description:
                        type: string
                        description: MCP Server 描述
                        example: description
                      labels:
                        type: array
                        items:
                          type: string
                        description: MCP Server 标签
                        example: ["tag1", "tag2"]
                      resource_names:
                        type: array
                        items:
                          type: string
                        description: MCP Server 关联的 resource 列表
                        example: ["resource1"]
                      is_public:
                        type: boolean
                        description: 是否公开，默认不公开
                        example: true
                      status:
                        type: integer
                        description: 状态：1：启用，0：关闭(默认关闭)
                        example: 1
                      protocol_type:
                        type: string
                        description: MCP 协议类型：sse（默认）、streamable_http
                        example: sse
                      target_app_codes:
                        type: array
                        items:
                          type: string
                        description: 主动授权的应用列表
                        example: ["app1", "app2"]
      responses:
        '200':
          description: 成功同步 MCP Servers
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          description: MCP Server ID
                          example: 1
                        name:
                          type: string
                          description: MCP Server name
                          example: gateway-stage-server1
                        action:
                          type: string
                          description: 操作类型
                          enum:
                            - created
                            - updated
                          example: created
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: post
          path: /backend/api/v2/sync/gateways/{gateway_name}/stages/{stage_name}/mcp-servers/
          matchSubpath: false
          timeout: 0
        pluginConfigs: [ ]
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: false
        descriptionEn: None

  /api/v2/sync/gateways/{gateway_name}/:
    post:
      operationId: v2_sync_gateway
      description: 同步网关
      tags:
        - v2_sync
      parameters:
        - name: gateway_name
          in: path
          required: true
          schema:
            type: string
          description: 网关名
          example: demo
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                description:
                  type: string
                  description: 网关描述
                  example: just for test
                maintainers:
                  type: array
                  items:
                    type: string
                  description: 网关管理员
                  example: ["admin"]
                is_public:
                  type: boolean
                  description: 网关是否公开，默认公开
                  example: true
            example:
              description: just for test
              maintainers: ["admin"]
              is_public: true
      responses:
        '200':
          description: 成功同步网关
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      id:
                        type: integer
                        description: 网关ID
                        example: 1
                      name:
                        type: string
                        description: 网关名称
                        example: demo
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: post
          path: /backend/api/v2/sync/gateways/{gateway_name}/
          matchSubpath: false
          timeout: 0
        pluginConfigs: [ ]
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: false
        descriptionEn: None
  /api/v2/sync/gateways/{gateway_name}/resources/:
    post:
      operationId: v2_sync_resources
      description: 同步网关资源
      tags:
        - v2_sync
      parameters:
        - name: gateway_name
          in: path
          required: true
          schema:
            type: string
          description: 网关名
          example: demo
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - content
              properties:
                content:
                  type: string
                  description: 网关资源 swagger 描述，可为 yaml 格式文本
                  example: "xxx"
                delete:
                  type: boolean
                  description: 是否删除未指定的资源
                  example: false
                doc_language:
                  type: string
                  description: 生成接口文档的语言：en 英文，zh 中文，不传不生成
                  enum:
                    - zh
                    - en
                  example: zh
            example:
              content: "xxx"
              delete: false
      responses:
        '200':
          description: 成功同步资源
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      added:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: integer
                        description: 新增的资源
                      updated:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: integer
                        description: 更新的资源
                      deleted:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: integer
                        description: 删除的资源
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: post
          path: /backend/api/v2/sync/gateways/{gateway_name}/resources/
          matchSubpath: false
          timeout: 0
        pluginConfigs: [ ]
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: false
        descriptionEn: None
  /api/v2/sync/gateways/{gateway_name}/resource-docs/:
    post:
      operationId: v2_sync_resource_doc
      description: 同步网关资源文档
      tags:
        - v2_sync
      parameters:
        - name: gateway_name
          in: path
          required: true
          schema:
            type: string
          description: 网关名
          example: demo
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - file
              properties:
                file:
                  type: string
                  format: binary
                  description: 资源文档的归档文件对象
      responses:
        '201':
          description: 成功导入资源文档
          content:
            application/json:
              schema:
                type: object
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: post
          path: /backend/api/v2/sync/gateways/{gateway_name}/resource-docs/
          matchSubpath: false
          timeout: 0
        pluginConfigs: [ ]
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: false
        descriptionEn: None
  /api/v2/sync/gateways/{gateway_name}/sdks/:
    post:
      operationId: v2_sync_generate_sdk
      description: 生成网关sdk
      tags:
        - v2_sync
      parameters:
        - name: gateway_name
          in: path
          required: true
          schema:
            type: string
          description: 网关名
          example: demo
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - resource_version
              properties:
                resource_version:
                  type: string
                  description: 资源版本的版本号
                  example: "1.0.1"
                languages:
                  type: array
                  items:
                    type: string
                  description: 需要生成SDK的语言列表，可选值：python
                  example: ["python"]
                version:
                  type: string
                  description: SDK 版本号，未设置时，将使用资源版本的版本号
                  example: "1.0.1"
            example:
              resource_version: "1.0.1"
              languages: ["python"]
              version: "1.0.1"
      responses:
        '200':
          description: 成功生成 SDK
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        name:
                          type: string
                          description: SDK 名称
                          example: bkapi-test
                        version:
                          type: string
                          description: SDK 版本号
                          example: "1.0.1"
                        url:
                          type: string
                          description: SDK 下载地址
                          example: "http://demo.example.com/bkapi-test-1.0.1.tar.gz"
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: post
          path: /backend/api/v2/sync/gateways/{gateway_name}/sdks/
          matchSubpath: false
          timeout: 0
        pluginConfigs: [ ]
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: false
        descriptionEn: None
  /api/v2/sync/gateways/{gateway_name}/permissions/:
    get:
      operationId: v2_sync_list_permissions
      description: 获取网关权限列表
      tags:
      - v2_sync
      parameters:
        - name: gateway_name
          in: path
          required: true
          schema:
            type: string
          description: 网关名称
          example: bk-apigateway
        - name: bk_app_code
          in: query
          schema:
            type: string
          description: 应用编码
          example: bk_apigateway
        - name: grant_dimension
          in: query
          schema:
            type: string
            enum:
              - gateway
              - resource
          description: 授权维度，gateway 为网关，resource 为资源
          example: gateway
      responses:
        '200':
          description: 成功返回权限列表
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      count:
                        type: integer
                        description: 总数
                        example: 1
                      results:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: integer
                              description: 权限记录 ID
                              example: 1
                            bk_app_code:
                              type: string
                              description: 应用编码
                              example: bk_apigateway
                            expires:
                              type: string
                              description: 过期时间
                              example: "2100-01-01T00:00:00Z"
                            grant_dimension:
                              type: string
                              description: 授权维度
                              example: gateway
                            resource_id:
                              type: integer
                              description: 资源 ID(resource 维度时存在)
                            resource_name:
                              type: string
                              description: 资源名称 (resource 维度时存在)
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: get
          path: /backend/api/v2/sync/gateways/{gateway_name}/permissions/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: false
        descriptionEn: None

  /api/v2/sync/gateways/{gateway_name}/permissions/grant/:
    post:
      operationId: v2_sync_grant_permission
      description: |
        网关权限授权，支持按网关维度或按资源维度为应用主动授权。

        - grant_dimension 为 gateway 时，授权整个网关的所有资源（包括后续新建资源），无需传 resource_names。
        - grant_dimension 为 resource 时，仅授权指定资源，需要通过 resource_names 指定资源列表。
      tags:
        - v2_sync
      parameters:
        - name: gateway_name
          in: path
          required: true
          schema:
            type: string
          description: 网关名
          example: demo
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - target_app_code
                - grant_dimension
              properties:
                target_app_code:
                  type: string
                  description: 待授权应用的 bk_app_code
                  example: bk-sops
                expire_days:
                  type: integer
                  description: 过期时间，单位天；0或不提供时表示永久权限
                  example: 360
                grant_dimension:
                  type: string
                  description: 授权维度。gateway - 按网关授权（包含所有资源）；resource - 按资源授权
                  enum:
                    - gateway
                    - resource
                  example: gateway
                resource_names:
                  type: array
                  items:
                    type: string
                  description: 资源名称列表，grant_dimension 为 resource 时必填
                  example: ["get_user", "create_user"]
            examples:
              gateway_grant:
                summary: 按网关维度授权
                value:
                  target_app_code: bk-sops
                  expire_days: 360
                  grant_dimension: gateway
              resource_grant:
                summary: 按资源维度授权
                value:
                  target_app_code: bk-sops
                  expire_days: 180
                  grant_dimension: resource
                  resource_names: ["get_user", "create_user"]
      responses:
        '201':
          description: 成功授权
          content:
            application/json:
              schema:
                type: object
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: post
          path: /backend/api/v2/sync/gateways/{gateway_name}/permissions/grant/
          matchSubpath: false
          timeout: 0
        pluginConfigs: [ ]
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: false
        descriptionEn: None

  /api/v2/sync/gateways/{gateway_name}/resource_versions/:
    post:
      operationId: v2_sync_create_resource_version
      description: 网关资源版本创建
      tags:
        - v2_sync
      parameters:
        - name: gateway_name
          in: path
          required: true
          schema:
            type: string
          description: 网关名
          example: demo
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - version
              properties:
                version:
                  type: string
                  description: 版本号，须符合 Semver 规范
                  example: "1.0.0"
                comment:
                  type: string
                  description: 版本说明
                  example: 这是一个什么样的新版本
            example:
              version: "1.0.0"
              comment: 这是一个什么样的新版本
      responses:
        '200':
          description: 成功创建资源版本
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      id:
                        type: integer
                        description: 资源版本ID
                        example: 1
                      version:
                        type: string
                        description: 版本号
                        example: "1.0.0"
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: post
          path: /backend/api/v2/sync/gateways/{gateway_name}/resource_versions/
          matchSubpath: false
          timeout: 0
        pluginConfigs: [ ]
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: false
        descriptionEn: None
    get:
      operationId: v2_sync_list_resource_versions
      description: 查询网关资源版本列表
      tags:
        - v2_sync
      parameters:
        - name: gateway_name
          in: path
          required: true
          schema:
            type: string
          description: 网关名
          example: demo
        - name: version
          in: query
          schema:
            type: string
          description: 版本号
          example: "1.0.0"
        - name: limit
          in: query
          schema:
            type: integer
            default: 10
          description: 最大返回条目数量，默认为 10
          example: 10
        - name: offset
          in: query
          schema:
            type: integer
            default: 0
          description: 相对于完整未分页数据的起始位置，默认为 0
          example: 0
      responses:
        '200':
          description: 成功返回资源版本列表
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      count:
                        type: integer
                        example: 1
                      has_next:
                        type: boolean
                        example: false
                      has_previous:
                        type: boolean
                        example: false
                      results:
                        type: array
                        items:
                          type: object
                          properties:
                            version:
                              type: string
                              description: 版本号
                              example: "1.0.0"
                            comment:
                              type: string
                              description: 版本说明
                              example: ""
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: get
          path: /backend/api/v2/sync/gateways/{gateway_name}/resource_versions/
          matchSubpath: false
          timeout: 0
        pluginConfigs: [ ]
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: false
        descriptionEn: None
  /api/v2/sync/gateways/{gateway_name}/resource_versions/latest/:
    get:
      operationId: v2_sync_get_resource_version_latest
      description: 获取网关资源版本最新版本
      tags:
        - v2_sync
      parameters:
        - name: gateway_name
          in: path
          required: true
          schema:
            type: string
          description: 网关名
          example: demo
      responses:
        '200':
          description: 成功返回最新资源版本
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      version:
                        type: string
                        description: 资源版本的版本号
                        example: "1.0.1"
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: get
          path: /backend/api/v2/sync/gateways/{gateway_name}/resource_versions/latest/
          matchSubpath: false
          timeout: 0
        pluginConfigs: [ ]
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: false
        descriptionEn: None
  /api/v2/sync/gateways/{gateway_name}/resource_versions/release/:
    post:
      operationId: v2_sync_release
      description: 网关资源版本发布
      tags:
        - v2_sync
      parameters:
        - name: gateway_name
          in: path
          required: true
          schema:
            type: string
          description: 网关名
          example: demo
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - version
              properties:
                version:
                  type: string
                  description: 待发布版本的版本号
                  example: "1.0.0"
                stage_names:
                  type: array
                  items:
                    type: string
                  description: 待发布环境列表
                  example: ["prod", "test", "dev"]
                comment:
                  type: string
                  description: 发布日志
                  example: 发布
            example:
              version: "1.0.0"
              stage_names: ["prod", "test", "dev"]
              comment: 发布
      responses:
        '200':
          description: 成功发布版本
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      version:
                        type: string
                        description: 发布版本号
                        example: "1.0.0"
                      stage_names:
                        type: array
                        items:
                          type: string
                        description: 发布环境名列表
                        example: ["prod", "test", "dev"]
      x-bk-apigateway-resource:
        isPublic: true
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: post
          path: /backend/api/v2/sync/gateways/{gateway_name}/resource_versions/release/
          matchSubpath: false
          timeout: 0
        pluginConfigs: [ ]
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: false
        descriptionEn: None
  /api/v2/inner/gateways/:
    get:
      operationId: v2_inner_list_gateways
      description: 获取网关列表
      tags:
      - v2_inner
      x-bk-apigateway-noneSchema: true
      responses:
        '200':
          description: 成功返回网关列表
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          description: 网关ID
                          example: 1
                        name:
                          type: string
                          description: 网关名称
                          example: bk-apigateway
                        description:
                          type: string
                          description: 网关描述
                          example: ""
                        maintainers:
                          type: array
                          items:
                            type: string
                          description: 网关管理员
                          example: ["admin"]
                        doc_maintainers:
                          type: object
                          properties:
                            type:
                              type: string
                              description: 类型，user 表示用户，service_account 表示服务号
                              example: user
                            contacts:
                              type: array
                              items:
                                type: string
                              description: 联系人
                              example: ["admin"]
                            service_account:
                              type: object
                              properties:
                                name:
                                  type: string
                                  description: 服务号名称
                                link:
                                  type: string
                                  description: 服务号链接
      x-bk-apigateway-resource:
        isPublic: false
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: get
          path: /backend/api/v2/inner/gateways/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: true
        descriptionEn: None
  /api/v2/inner/gateways/{gateway_name}/:
    get:
      operationId: v2_inner_get_gateway
      description: 获取网关
      tags:
      - v2_inner
      parameters:
        - name: gateway_name
          in: path
          required: true
          schema:
            type: string
          description: 网关名称
          example: bk-apigateway
      responses:
        '200':
          description: 成功返回网关详情
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      id:
                        type: integer
                        description: 网关ID
                        example: 1
                      name:
                        type: string
                        description: 网关名称
                        example: bk-apigateway
                      description:
                        type: string
                        description: 网关描述
                        example: ""
                      maintainers:
                        type: array
                        items:
                          type: string
                        description: 网关管理员
                        example: ["admin"]
                      doc_maintainers:
                        type: object
                        properties:
                          type:
                            type: string
                            description: 类型，user 表示用户，service_account 表示服务号
                          contacts:
                            type: array
                            items:
                              type: string
                            description: 联系人
                          service_account:
                            type: object
                            properties:
                              name:
                                type: string
                                description: 服务号名称
                              link:
                                type: string
                                description: 服务号链接
      x-bk-apigateway-resource:
        isPublic: false
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: get
          path: /backend/api/v2/inner/gateways/{gateway_name}/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: true
        descriptionEn: None
    delete:
      operationId: v2_inner_delete_gateway
      description: 删除网关，仅支持 bp- 开头的网关
      tags:
      - v2_inner
      parameters:
        - name: gateway_name
          in: path
          required: true
          schema:
            type: string
          description: 网关名称，必须以 bp- 开头
          example: bp-test
      responses:
        '204':
          description: 成功删除网关，无响应体
      x-bk-apigateway-resource:
        isPublic: false
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: delete
          path: /backend/api/v2/inner/gateways/{gateway_name}/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: true
        descriptionEn: Delete gateway, only supports gateways starting with bp-
  /api/v2/inner/gateways/{gateway_name}/status/:
    put:
      operationId: v2_inner_update_gateway_status
      description: 更新网关状态（停用/启用），仅支持 bp- 开头的网关
      tags:
      - v2_inner
      parameters:
        - name: gateway_name
          in: path
          required: true
          schema:
            type: string
          description: 网关名称，必须以 bp- 开头
          example: bp-test
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - status
              properties:
                status:
                  type: integer
                  description: 网关状态，0：停用，1：启用
                  example: 0
            example:
              status: 0
      responses:
        '204':
          description: 成功更新网关状态，无响应体
      x-bk-apigateway-resource:
        isPublic: false
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: put
          path: /backend/api/v2/inner/gateways/{gateway_name}/status/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: true
        descriptionEn: Update gateway status (disable/enable), only supports gateways starting with bp-
  /api/v2/inner/gateways/{gateway_name}/permissions/resources/:
    get:
      operationId: v2_inner_list_gateway_permission_resources
      description: 获取网关资源
      tags:
      - v2_inner
      parameters:
        - name: gateway_name
          in: path
          required: true
          schema:
            type: string
          description: 网关名称
          example: bk-apigateway
        - name: target_app_code
          in: query
          required: true
          schema:
            type: string
          description: 申请权限的应用，应于当前请求的应用一致
          example: bk-001
      responses:
        '200':
          description: 成功返回网关资源列表
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          description: 资源ID
                          example: 2321
                        name:
                          type: string
                          description: 资源名称
                          example: test
                        gateway_name:
                          type: string
                          description: 网关名称
                          example: test-gateway
                        gateway_id:
                          type: integer
                          description: 网关ID
                          example: 6
                        description:
                          type: string
                          description: 资源描述
                          example: ""
                        description_en:
                          type: string
                          nullable: true
                          description: 资源英文描述
                        expires_in:
                          type: integer
                          nullable: true
                          description: 有效期
                        permission_level:
                          type: string
                          description: 权限级别
                          example: normal
                        permission_status:
                          type: string
                          description: 权限状态
                          example: pending
                        permission_action:
                          type: string
                          description: 权限操作
                        doc_link:
                          type: string
                          description: 文档地址
                          example: "http://test.com/"
      x-bk-apigateway-resource:
        isPublic: false
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: get
          path: /backend/api/v2/inner/gateways/{gateway_name}/permissions/resources/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: true
        descriptionEn: None
  /api/v2/inner/gateways/{gateway_name}/permissions/app-permissions/allow-apply-by-gateway/:
    get:
      operationId: v2_inner_check_is_allowed_apply_by_gateway
      description: 是否允许按网关申请资源权限
      tags:
      - v2_inner
      responses:
        default:
          description: ''
          content:
            application/json:
              schema: {}
      x-bk-apigateway-resource:
        isPublic: false
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: get
          path: /backend/api/v2/inner/gateways/{gateway_name}/permissions/app-permissions/allow-apply-by-gateway/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: true
        descriptionEn: None
  /api/v2/inner/gateways/{gateway_name}/permissions/app-permissions/apply/:
    post:
      operationId: v2_inner_apply_gateway_resource_permission
      description: 网关资源权限申请
      tags:
      - v2_inner
      parameters:
        - name: gateway_name
          in: path
          required: true
          schema:
            type: string
          description: 网关名称
          example: bk-apigateway
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - target_app_code
                - expire_days
                - grant_dimension
              properties:
                target_app_code:
                  type: string
                  description: 申请权限的应用，应于当前请求的应用一致
                  example: bk-001
                resource_ids:
                  type: array
                  items:
                    type: integer
                  description: 资源ID列表
                  example: []
                reason:
                  type: string
                  description: 申请理由
                  example: ""
                expire_days:
                  type: integer
                  description: 过期时间，0：永久，180：6个月，360：12个月
                  example: 180
                grant_dimension:
                  type: string
                  description: 授权维度，api：按网关，resource：按资源
                  example: api
            example:
              target_app_code: ""
              resource_ids: []
              reason: ""
              expire_days: 180
              grant_dimension: api
      responses:
        '200':
          description: 成功返回申请记录ID
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      record_id:
                        type: integer
                        description: 权限申请单的单据ID
                        example: 6
      x-bk-apigateway-resource:
        isPublic: false
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: post
          path: /backend/api/v2/inner/gateways/{gateway_name}/permissions/app-permissions/apply/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: true
        descriptionEn: None
  /api/v2/inner/gateways/permissions/renew/:
    post:
      operationId: v2_inner_renew_resource_permission
      description: 权限续期
      tags:
      - v2_inner
      responses:
        default:
          description: ''
          content:
            application/json:
              schema: {}
      x-bk-apigateway-resource:
        isPublic: false
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: post
          path: /backend/api/v2/inner/gateways/permissions/renew/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: true
        descriptionEn: None
  /api/v2/inner/gateways/permissions/app-permissions/:
    get:
      operationId: v2_inner_list_app_resource_permissions
      description: 已申请权限列表
      tags:
      - v2_inner
      parameters:
        - name: target_app_code
          in: query
          required: true
          schema:
            type: string
          description: 申请权限的应用，应于当前请求的应用一致
          example: bk-001
        - name: expire_days_range
          in: query
          schema:
            type: integer
          description: 过期时间范围
          example: 30
      responses:
        '200':
          description: 成功返回已申请权限列表
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          description: 资源ID
                          example: 1
                        name:
                          type: string
                          description: 资源名称
                          example: test
                        gateway_name:
                          type: string
                          description: 网关名称
                          example: test
                        gateway_id:
                          type: integer
                          description: 网关ID
                          example: 4
                        description:
                          type: string
                          description: 资源描述
                        description_en:
                          type: string
                          description: 资源英文描述
                        expires_in:
                          type: integer
                          nullable: true
                          description: 有效期
                        permission_level:
                          type: string
                          description: 权限级别
                          example: normal
                        permission_status:
                          type: string
                          description: 权限状态
                          example: owned
                        permission_action:
                          type: string
                          description: 权限操作
                        doc_link:
                          type: string
                          description: 文档地址
      x-bk-apigateway-resource:
        isPublic: false
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: get
          path: /backend/api/v2/inner/gateways/permissions/app-permissions/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: true
        descriptionEn: None
  /api/v2/inner/gateways/permissions/apply-records/:
    get:
      operationId: v2_inner_list_resource_permission_apply_records
      description: 资源权限申请记录
      tags:
      - v2_inner
      responses:
        default:
          description: ''
          content:
            application/json:
              schema: {}
      x-bk-apigateway-resource:
        isPublic: false
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: get
          path: /backend/api/v2/inner/gateways/permissions/apply-records/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: true
        descriptionEn: None
  /api/v2/inner/gateways/permissions/apply-records/{record_id}/:
    get:
      operationId: v2_inner_retrieve_resource_permission_apply_record
      description: 资源权限申请记录详情
      tags:
      - v2_inner
      parameters:
        - name: record_id
          in: path
          required: true
          schema:
            type: integer
          description: 申请记录 ID
          example: 1
        - name: target_app_code
          in: query
          required: true
          schema:
            type: string
          description: 申请权限的应用，应于当前请求的应用一致
          example: bk-001
      responses:
        '200':
          description: 成功返回资源权限申请记录详情
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      id:
                        type: integer
                        description: 申请ID
                        example: 1
                      bk_app_code:
                        type: string
                        description: 蓝鲸应用编码
                        example: test
                      applied_by:
                        type: string
                        description: 申请人
                        example: admin
                      applied_time:
                        type: string
                        description: 申请时间
                        example: "2025-01-01 00:00:00 +0800"
                      handled_by:
                        type: array
                        items:
                          type: string
                        description: 审批人
                        example: ["admin"]
                      handled_time:
                        type: string
                        nullable: true
                        description: 审批时间
                      apply_status:
                        type: string
                        description: 审批状态
                        example: pending
                      apply_status_display:
                        type: string
                        description: 审批状态描述
                        example: 待审批
                      grant_dimension:
                        type: string
                        description: 授权维度，api：按网关，resource：按资源
                        example: api
                      comment:
                        type: string
                        description: 审批内容
                      reason:
                        type: string
                        description: 申请理由
                      expire_days:
                        type: integer
                        description: 过期时间
                        example: 180
                      gateway_name:
                        type: string
                        description: 网关名称
                        example: test
      x-bk-apigateway-resource:
        isPublic: false
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: get
          path: /backend/api/v2/inner/gateways/permissions/apply-records/{record_id}/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: true
        descriptionEn: None
  /api/v2/inner/esb/systems/:
    get:
      operationId: v2_inner_list_esb_systems
      description: 查询组件系统列表
      tags:
      - v2_inner
      responses:
        default:
          description: ''
          content:
            application/json:
              schema: {}
      x-bk-apigateway-resource:
        isPublic: false
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: get
          path: /backend/api/v2/inner/esb/systems/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: true
        descriptionEn: None
  /api/v2/inner/esb/systems/{system_id}/permissions/components/:
    get:
      operationId: v2_inner_list_esb_system_permission_components
      description: 查询系统权限组件
      tags:
      - v2_inner
      parameters:
        - name: system_id
          in: path
          required: true
          schema:
            type: integer
          description: 系统 ID
          example: 1
        - name: target_app_code
          in: query
          required: true
          schema:
            type: string
          description: 申请权限的应用，应于当前请求的应用一致
          example: bk-001
      responses:
        '200':
          description: 成功返回系统权限组件列表
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          description: 组件ID
                          example: 1
                        name:
                          type: string
                          description: 组件名称
                          example: get_doc_link_by_path
                        system_name:
                          type: string
                          description: 系统名称
                          example: BK_DOCS_CENTER
                        system_id:
                          type: integer
                          description: 系统ID
                          example: 16
                        description:
                          type: string
                          description: 组件描述
                          example: 根据md名查询md所在链接
                        description_en:
                          type: string
                          description: 组件英文描述
                          example: Query the link of the document according to the MD name
                        expires_in:
                          type: integer
                          nullable: true
                          description: 有效期
                        permission_level:
                          type: string
                          description: 权限级别
                          example: unlimited
                        permission_status:
                          type: string
                          description: 权限状态
                          example: unlimited
                        permission_action:
                          type: string
                          description: 权限操作
                        doc_link:
                          type: string
                          description: 文档地址
                        tag:
                          type: string
                          description: 标签
      x-bk-apigateway-resource:
        isPublic: false
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: get
          path: /backend/api/v2/inner/esb/systems/{system_id}/permissions/components/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: true
        descriptionEn: None
  /api/v2/inner/esb/systems/{system_id}/permissions/apply/:
    post:
      operationId: v2_inner_apply_esb_system_component_permissions
      description: '创建申请ESB组件权限的申请单据'
      tags:
      - v2_inner
      responses:
        default:
          description: ''
          content:
            application/json:
              schema: {}
      x-bk-apigateway-resource:
        isPublic: false
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: post
          path: /backend/api/v2/inner/esb/systems/{system_id}/permissions/apply/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: true
        descriptionEn: None
  /api/v2/inner/esb/systems/permissions/renew/:
    post:
      operationId: v2_inner_renew_esb_component_permissions
      description: ESB 组件权限续期
      tags:
      - v2_inner
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - target_app_code
                - expire_days
              properties:
                target_app_code:
                  type: string
                  description: 申请权限的应用，应于当前请求的应用一致
                  example: bk-001
                component_ids:
                  type: array
                  items:
                    type: integer
                  description: 组件ID列表
                  example: []
                expire_days:
                  type: integer
                  description: 过期时间，0：永久，180：6个月，360：12个月
                  example: 180
                reason:
                  type: string
                  description: 申请原因
                  example: ""
            example:
              target_app_code: "string"
              expire_days: 180
              component_ids: []
              reason: ""
      responses:
        '200':
          description: 成功续期
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
      x-bk-apigateway-resource:
        isPublic: false
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: post
          path: /backend/api/v2/inner/esb/systems/permissions/renew/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: true
        descriptionEn: None
  /api/v2/inner/esb/systems/permissions/app-permissions/:
    get:
      operationId: v2_inner_list_app_esb_component_permissions
      description: 已申请权限列表
      tags:
      - v2_inner
      parameters:
        - name: target_app_code
          in: query
          required: true
          schema:
            type: string
          description: 待授权应用
          example: bk-001
        - name: expire_days_range
          in: query
          schema:
            type: integer
          description: 过期时间范围
          example: 30
      responses:
        '200':
          description: 成功返回已申请权限列表
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          description: 组件ID
                          example: 1
                        name:
                          type: string
                          description: 组件名称
                          example: test
                        system_name:
                          type: string
                          description: 系统名称
                        system_id:
                          type: integer
                          description: 系统ID
                        description:
                          type: string
                          description: 组件描述
                        description_en:
                          type: string
                          description: 组件英文描述
                        expires_in:
                          type: integer
                          nullable: true
                          description: 有效期
                        permission_level:
                          type: string
                          description: 权限级别
                          example: normal
                        permission_status:
                          type: string
                          description: 权限状态
                          example: owned
                        permission_action:
                          type: string
                          description: 权限操作
                        doc_link:
                          type: string
                          description: 文档地址
                        tag:
                          type: string
                          description: 标签
      x-bk-apigateway-resource:
        isPublic: false
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: get
          path: /backend/api/v2/inner/esb/systems/permissions/app-permissions/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: true
        descriptionEn: None
  /api/v2/inner/esb/systems/permissions/apply-records/:
    get:
      operationId: v2_inner_list_app_esb_component_permission_apply_records
      description: 查询应用权限申请记录列表
      tags:
      - v2_inner
      responses:
        default:
          description: ''
          content:
            application/json:
              schema: {}
      x-bk-apigateway-resource:
        isPublic: false
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: get
          path: /backend/api/v2/inner/esb/systems/permissions/apply-records/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: true
        descriptionEn: None
  /api/v2/inner/esb/systems/permissions/apply-records/{record_id}/:
    get:
      operationId: v2_inner_get_app_esb_component_permission_apply_record
      description: 查询应用权限申请记录详情
      tags:
      - v2_inner
      parameters:
        - name: record_id
          in: path
          required: true
          schema:
            type: integer
          description: 记录 ID
          example: 1
        - name: target_app_code
          in: query
          required: true
          schema:
            type: string
          description: 申请权限的应用，应于当前请求的应用一致
          example: bk-001
        - name: applied_by
          in: query
          schema:
            type: string
          description: 申请人
          example: admin
      responses:
        '200':
          description: 成功返回应用权限申请记录详情
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      id:
                        type: integer
                        description: 申请ID
                        example: 1
                      bk_app_code:
                        type: string
                        description: 蓝鲸应用编码
                        example: test
                      applied_by:
                        type: string
                        description: 申请人
                        example: admin
                      applied_time:
                        type: string
                        description: 申请时间
                        example: "2025-01-01 00:00:00 +0800"
                      handled_by:
                        type: array
                        items:
                          type: string
                        description: 审批人
                        example: ["admin"]
                      handled_time:
                        type: string
                        nullable: true
                        description: 审批时间
                      apply_status:
                        type: string
                        description: 审批状态
                        example: pending
                      apply_status_display:
                        type: string
                        description: 审批状态描述
                        example: 待审批
                      grant_dimension:
                        type: string
                        description: 授权维度，api：按网关，resource：按资源
                        example: api
                      comment:
                        type: string
                        description: 审批内容
                      reason:
                        type: string
                        description: 申请理由
                      expire_days:
                        type: integer
                        description: 过期时间
                        example: 180
                      gateway_name:
                        type: string
                        description: 网关名称
                        example: test
      x-bk-apigateway-resource:
        isPublic: false
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: get
          path: /backend/api/v2/inner/esb/systems/permissions/apply-records/{record_id}/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: true
        descriptionEn: None
  /api/v2/inner/mcp-server/permissions/:
    get:
      operationId: v2_inner_list_mcp_server_permissions
      description: 'mcp_server 申请权限列表'
      tags:
      - v2_inner
      responses:
        default:
          description: ''
          content:
            application/json:
              schema: {}
      x-bk-apigateway-resource:
        isPublic: false
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: get
          path: /backend/api/v2/inner/mcp-server/permissions/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: true
        descriptionEn: None
  /api/v2/inner/mcp-server/permissions/apply/:
    post:
      operationId: v2_inner_apply_mcp_server_permission
      description: 'mcp_server 权限申请/批量申请'
      tags:
      - v2_inner
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - target_app_code
                - mcp_server_ids
                - applied_by
                - reason
              properties:
                target_app_code:
                  type: string
                  description: 申请权限的应用，应于当前请求的应用一致
                  example: test
                mcp_server_ids:
                  type: array
                  items:
                    type: integer
                  description: mcp_server ID 列表
                  example: [1, 2]
                applied_by:
                  type: string
                  description: 申请人
                  example: admin
                reason:
                  type: string
                  description: 申请理由
                  example: test
            example:
              target_app_code: test
              mcp_server_ids: [1, 2]
              applied_by: admin
              reason: test
      responses:
        '200':
          description: 成功申请权限
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
      x-bk-apigateway-resource:
        isPublic: false
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: post
          path: /backend/api/v2/inner/mcp-server/permissions/apply/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: true
        descriptionEn: None
  /api/v2/inner/mcp-server/permissions/app-permissions/:
    get:
      operationId: v2_inner_list_mcp_server_app_permissions
      description: 'mcp_server 已申请权限列表'
      tags:
      - v2_inner
      responses:
        default:
          description: ''
          content:
            application/json:
              schema: {}
      x-bk-apigateway-resource:
        isPublic: false
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: get
          path: /backend/api/v2/inner/mcp-server/permissions/app-permissions/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: true
        descriptionEn: None
  /api/v2/inner/mcp-server/permissions/apply-records/:
    get:
      operationId: v2_inner_list_mcp_server_permission_apply_records
      description: 'mcp_server 申请记录列表'
      tags:
      - v2_inner
      parameters:
        - name: target_app_code
          in: query
          required: true
          schema:
            type: string
          description: 申请权限的应用，应于当前请求的应用一致
          example: bk-001
        - name: applied_by
          in: query
          schema:
            type: string
          description: 申请人
          example: admin
        - name: applied_time_start
          in: query
          schema:
            type: integer
          description: 申请开始时间
        - name: applied_time_end
          in: query
          schema:
            type: integer
          description: 申请截止时间
        - name: apply_status
          in: query
          schema:
            type: string
          description: 申请状态，approved：全部通过，rejected：全部驳回，pending：待审批
          example: pending
        - name: query
          in: query
          schema:
            type: string
          description: 查询条件
      responses:
        '200':
          description: 成功返回 mcp_server 申请记录列表
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        mcp_server:
                          type: object
                          properties:
                            id:
                              type: integer
                              description: mcp_server ID
                              example: 1
                            name:
                              type: string
                              description: mcp_server 名称
                              example: bk-apigateway-prod-s1
                            title:
                              type: string
                              description: mcp_server 中文名/显示名称
                              example: 测试服务
                            description:
                              type: string
                              description: mcp_server 描述
                              example: test
                            tools_count:
                              type: integer
                              description: mcp_server 工具数量
                              example: 1
                            doc_link:
                              type: string
                              description: mcp_server 文档访问地址
                        record:
                          type: object
                          properties:
                            id:
                              type: integer
                              description: 申请记录 ID
                              example: 1
                            applied_by:
                              type: string
                              description: 申请人
                              example: admin
                            applied_time:
                              type: string
                              description: 申请时间
                              example: "2025-01-01 00:00:00 +0800"
                            handled_by:
                              type: array
                              items:
                                type: string
                              description: 审批人
                              example: ["admin"]
                            handled_time:
                              type: string
                              nullable: true
                              description: 审批时间
                            apply_status:
                              type: string
                              description: 审批状态（approved：通过，rejected：驳回，pending：待审批）
                              example: pending
                            apply_status_display:
                              type: string
                              description: 审批状态描述
                              example: 待审批
                            comment:
                              type: string
                              description: 审批内容
                            reason:
                              type: string
                              description: 申请理由
                            expire_days:
                              type: integer
                              description: 过期时间
                              example: 0
      x-bk-apigateway-resource:
        isPublic: false
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: get
          path: /backend/api/v2/inner/mcp-server/permissions/apply-records/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: true
        descriptionEn: None
  /api/v2/inner/mcp-server/permissions/apply-records/{record_id}/:
    get:
      operationId: v2_inner_retrieve_mcp_server_permission_apply_record
      description: 'mcp_server 申请记录详情'
      tags:
      - v2_inner
      responses:
        default:
          description: ''
          content:
            application/json:
              schema: {}
      x-bk-apigateway-resource:
        isPublic: false
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: get
          path: /backend/api/v2/inner/mcp-server/permissions/apply-records/{record_id}/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: true
        descriptionEn: None
  /api/v2/inner/mcp-servers/:
    get:
      operationId: v2_inner_list_mcp_server
      description: 获取全量的 MCPServer 列表（应用态接口）
      tags:
      - v2_inner
      responses:
        default:
          description: ''
          content:
            application/json:
              schema: {}
      x-bk-apigateway-resource:
        isPublic: false
        allowApplyPermission: false
        matchSubpath: false
        enableWebsocket: false
        backend:
          name: default
          method: get
          path: /backend/api/v2/inner/mcp-servers/
          matchSubpath: false
          timeout: 0
        pluginConfigs: []
        authConfig:
          userVerifiedRequired: false
          appVerifiedRequired: true
          resourcePermissionRequired: true
        descriptionEn: None
